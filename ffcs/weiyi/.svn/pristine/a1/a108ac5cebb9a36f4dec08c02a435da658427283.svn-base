{if $do == 'install'}{php $_W['breadcrumb'] = array(array('title'=>'系统管理'),array('title'=>'支付管理 '),array('title'=>'安装支付 '))}{/if}
{if $do == 'post'}{php $_W['breadcrumb'] = array(array('title'=>'系统管理'),array('title'=>'支付管理 '),array('title'=>'编辑支付 '))}{/if}
{if $do == 'display'}{php $_W['breadcrumb'] = array(array('title'=>'系统管理'),array('title'=>'支付管理 '),array('title'=>'支付列表 '))}{/if}
{template 'common/header'}
<div class="page-header">
    <h1>
        {if $do == 'install'}<i class="icon-pencil"></i> 安装支付{elseif $do == 'post'}<i class="icon-pencil"></i> 编辑支付{else}<i class="icon-user"></i> 支付列表{/if}
    </h1>
</div>
<ul class="nav nav-tabs  padding-24 tab-color-blue background-blue " style="margin-bottom: 20px;">
	<li {if $do == 'post'||$do == 'install'}class="active"{/if}><a href="javascript:;">{if $id}编辑{else}安装{/if}支付</a></li>
	<li {if $do == 'display'}class="active"{/if}><a href="{php echo create_url('pay/payment/display');}">支付列表</a></li>
</ul>
{if $do == 'post'||$do == 'install'}
<form class="form-horizontal form" action="" method="post" enctype="multipart/form-data" id="form_payment" onsubmit="if($('#name').val()==''){alert('请填写支付方式名称');return false;}else{return true;}">
<div class="main">
	<input type="hidden" name="id" value="{$id}" />
    <input type="hidden" name="pay_name" value="{$pay_name}" />
	<input type="hidden" name="pay_code" value="{$pay_code}" />

	<table class="tb">
		<tr>
			<th><label for="">支付方式</label></th>
			<td>
				{$pay_name}
			</td>
		</tr>
        <tr>
			<th><label for="">支付方式名称</label></th>
			<td>
				<input type="text" class="span4" name="name" id="name" value="{php echo $name ? $name : $pay_name;}" />
			</td>
		</tr>
        {loop $config $conf $name}
        <tr>
			<th><label for="">{$name['name']}</label></th>
			<td>
            	{if $name['type'] == 'text'}
					<input type="text" class="span4" name="config_value[]" id="{$conf}" value="{$name['value']}" />
                {elseif $name['type'] == 'select'}
                	<select name="config_value[]">
                     {loop $name['range'] $key $v}
                    <option value="{$key}" {if $key == $name['value']} selected="selected" {/if} >{$v}</option>
                     {/loop}
                    </select>
                {/if}
                <input type="hidden" value="{$conf}" name="config_name[]"/>
			</td>
		</tr>
        {/loop}
		<tr>
			<th><label for="">支付方式描述</label></th>
			<td>
				<textarea rows="4" name="description" id="description" class="span6">{$pay_desc}</textarea>
			</td>
		</tr>
        <tr>
			<th><label for="">排序</label></th>
			<td>
				<input type="text" class="span1" name="order" id="order" value="{$order}" />
			</td>
		</tr>
		<tr>
			<th></th>
			<td>
				<input name="token" type="hidden" value="{$_W['token']}" />
				<input type="submit" class="btn btn-sm btn-primary" name="submit" value="提交" />
			</td>
		</tr>
	</table>
</div>
</form>
{elseif $do == 'display'}
<form action="" method="post">
<div class="main">
	<div>
		<table class="table table-striped table-bordered table-hover">
			<thead class="navbar-inner">
				<tr>
					<th style="width:150px;">支付方式名称</th>
                    <th style="min-width:80px;">版本</th>
                    <th style="min-width:200px;">描述</th>
                    <th style="min-width:80px;">排序</th>
					<th style="min-width:150px;">操作</th>
				</tr>
			</thead>
			<tbody>
            	{if is_array($list['data'])}
				{loop $list['data'] $item}
				<tr>
					<td>{$item['pay_name']}</td>
                    <td>{$item['version']}</td>
                    <td>{$item['pay_desc']}</td>
					<td>{$item['order']}</td>
					<td>
                    {if $item['status']}
                    <span><a href="{php echo create_url('pay/payment/post', array('id' => $item['id']))}">编辑</a>&nbsp;&nbsp;<a href="{php echo create_url('pay/payment/uninstall', array('id' => $item['id']))}">卸载</a></span>
                    {else}
                    <span><a href="{php echo create_url('pay/payment/install', array('code' => $item['pay_code']))}">安装</a></span>
                    {/if}
                    </td>
				</tr>
				{/loop}
                {/if}
			</tbody>
		</table>
	</div>
</div>
</form>
{/if}
{template 'common/footer'}