<?php $load_js=array('jscolor/jscolor');?>
<?php $load_css=array('mircomember/card');?>
{template 'common/header'}

<div class="main">
    <form action="" method="post" class="form-horizontal form">
    <h4>会员卡设置</h4>

        <table id="form"
               class="tb reply-news-edit ">
            <tr>
                <th>会员名称</th>
                <td><input type="text" id="cardname" class="span7" placeholder=""
                           name="name" value="{if empty($card_setting['name'])}{$_W['account']['name']}{else}{$card_setting['name']}{/if}" onchange="$(this).setName('.mc-name')"></td>
                <td rowspan="9">
                    <div class="img-preview">
                        <div class="img-wrapper">
                            <img class="i-img" src="">
                            <img class="mc"  src="">
                            <div class="mc-name"></div>
                            <div class="mc-number"><em>会员卡号</em>88888</div>
                        </div>
                        <div>
                            <ul class="nav nav-tabs nav-stacked">
                            </ul>
                        </div>
                    </div>
                    <script type="text/javascript">
                        $(function(){
                            $('#cname_color').setColor('.mc-name');
                            $('#numbercolor').setColor('.mc-number');
                            $('#select_bg,').setBackground('.i-img');
                            $('#cardname').setName('.mc-name');
                            if($('#background-value').length){
                                $('#background-value').setBackground('.i-img');
                            }
                        })
                        $.fn.setColor = function(target){
                            return  $(target).css('color',$(this).val());
                        }
                        $.fn.setBackground = function(target){
                            return  $(target).attr('src',$(this).val());
                        }
                        $.fn.setName = function(target){
                            return  $(target).html($(this).val());
                        }
                        $.fn.setImgVal = function(target){
                            return  $(target).val($(this).val());
                        }
                    </script>
                </td>
            </tr>
            <tr>
                <th>会员卡颜色</th>
                <td><input type="text" name="namecolor" id="cname_color" onchange="$(this).setColor('.mc-name')" value="{if empty($card_setting['namecolor'])}#BBBBBB{else}{$card_setting['namecolor']}{/if}" class="span7 color"></td>
                <td></td>
            </tr>
            <tr>
                <th>会员背景</th>
                <td><select name="sysbackground" id="select_bg" onchange="$(this).setBackground('.i-img'); $('#bgtype').val('1');" class="input-large" style="width: 227px">
                    <option selected="" value="./resource/style/mircomember/cards/card_bg21.png">请选择会员卡背景图</option>
                    <option value="./resource/style/mircomember/cards/card_bg01.png">01 </option>
                    <option value="./resource/style/mircomember/cards/card_bg02.png">02</option>
                    <option value="./resource/style/mircomember/cards/card_bg03.png">03</option>
                    <option value="./resource/style/mircomember/cards/card_bg04.png">04</option>
                    <option value="./resource/style/mircomember/cards/card_bg05.png">05</option>
                    <option value="./resource/style/mircomember/cards/card_bg06.png">06</option>
                    <option value="./resource/style/mircomember/cards/card_bg07.png">07</option>
                    <option value="./resource/style/mircomember/cards/card_bg08.png">08</option>
                    <option value="./resource/style/mircomember/cards/card_bg09.png">09</option>
                    <option value="./resource/style/mircomember/cards/card_bg10.png">10</option>
                    <option value="./resource/style/mircomember/cards/card_bg11.png">11</option>
                    <option value="./resource/style/mircomember/cards/card_bg12.png">12</option>
                    <option value="./resource/style/mircomember/cards/card_bg13.png">13</option>
                    <option value="./resource/style/mircomember/cards/card_bg14.png">14</option>
                    <option value="./resource/style/mircomember/cards/card_bg15.png">15</option>
                    <option value="./resource/style/mircomember/cards/card_bg16.png">16</option>
                    <option value="./resource/style/mircomember/cards/card_bg17.png">17</option>
                    <option value="./resource/style/mircomember/cards/card_bg18.png">18</option>
                    <option value="./resource/style/mircomember/cards/card_bg19.png">19</option>
                    <option value="./resource/style/mircomember/cards/card_bg20.png">20</option>
                    <option value="./resource/style/mircomember/cards/card_bg21.png">21</option>
                    <option value="./resource/style/mircomember/cards/card_bg22.png">22</option>
                    <option value="./resource/style/mircomember/cards/card_bg23.png">23</option>
                </select></td>
            </tr>
            <script type="text/javascript">
                var sysbg = '{$card_setting['sysbackground']}';
                $('#select_bg option').each(function(index){
                    if($(this).val() == sysbg){
                        $(this).attr('selected','selected');
                    }
                });
            </script>
            <tr>
                <th>自己设置背景</th>
                <td>
                    <div id="" class="uneditable-input reply-edit-cover">
                        <div class="detail">
                            <span class="pull-right">大图片建议尺寸：534像素 * 318像素</span>
                            <input
                                    type="button" id="background"
                                    fieldname="background"
                                    class="btn btn-sm btn-primary reply-edit-cover-upload"
                                    value="<i class='icon-upload-alt'></i> 上传" style="" />
                            <button type="button" class="btn btn-sm"
                                    id="upload-delete" onclick="doDeleteItemImage(this, 'background',{deleteSuccess:bg_delete_success});"
                                    style="{if empty($card_setting['background'])} display:none;{/if}">
                                <i class="icon-remove"></i> 删除</button>
                        </div>
                        {if !empty($card_setting)} <input type="hidden" id="background-value"
                                                              name="background" value="{$card_setting[background]}">
                        <div id="upload-file-view" class="upload-view">
                            <img width="100" src="{$_W['attachurl']}{$card_setting[background]}">&nbsp;&nbsp;
                        </div>
                        <script type="text/javascript">
                            $(function(){
                                var bgtype = '{$card_setting['bgtype']}';
                                if(bgtype == '2'){
                                    $('.i-img').attr('src','{$_W['attachurl']}{$card_setting[background]}');
                                }else{
                                    $('.i-img').attr('src','{$card_setting[sysbackground]}');
                                }
                            })
                        </script>
                        {else}
                        <div id="upload-file-view"></div>
                        {/if}
                    </div>
                </td>
            </tr>
            <input type="hidden" name='bgtype' id="bgtype" value="{if !empty($card_setting['bgtype'])}{$card_setting['bgtype']}{/if}"/>
            <script type="text/javascript">
                kindeditorUploadBtn($('#background'),{
                    uploadSuccess : function(obj ,url){
                      $('.i-img').attr('src', url);
                      $('#bgtype').val('2');
                    }
                });
                //会员卡背景图片删除回掉
                function bg_delete_success(){
                    $('.i-img').attr('src', $('#select_bg').val());
                    $('#bgtype').val('1');
                }
            </script>
            <tr>
                <th>会员卡图标</th>
                <td>
                    <div id="" class="uneditable-input reply-edit-cover">
                        <div class="detail">
                            <span class="pull-right">大图片建议尺寸：152像素 * 70像素 透明图片</span>
                            <input
                                    type="button" id="icon"
                                    fieldname="icon"
                                    class="btn btn-mini reply-edit-cover-upload"
                                    value="<i class='icon-upload-alt'></i> 上传" style="" />
                            <button type="button" class="btn btn-sm"
                                    id="upload-delete" onclick="doDeleteItemImage(this, 'icon',{deleteSuccess:icon_delete_success})"
                                    style="{if empty($card_setting['icon'])} display:none;{/if}">
                                <i class="icon-remove"></i> 删除</button>
                        </div>
                        {if !empty($card_setting)}
                        <input type="hidden"
                               name="icon" value="{$card_setting[icon]}">

                        <div id="upload-file-view" class="upload-view">
                            <img width="100" src="{$_W['attachurl']}{$card_setting[icon]}">&nbsp;&nbsp;
                        </div>
                        <script type="text/javascript">
                            $(function(){
                                $('.mc').attr('src','{$_W['attachurl']}{$card_setting[icon]}');
                            })
                        </script>
                        {else}
                        <div id="upload-file-view"></div>
                        {/if}
                    </div>
                </td>
                <td></td>
            </tr>
            <script type="text/javascript">
                kindeditorUploadBtn($('#icon'),{
                    uploadSuccess : function(obj ,url){
                        $('.mc').attr('src', url);
                    }
                });
                function icon_delete_success(){
                    $('.mc').attr('src', '');
                }
            </script>
            <tr>
                <th>会员文字颜色</th>
                <td><input type="text" name="numcolor" id="numbercolor" value="{if empty($card_setting['numcolor'])}#AAAAAA{else}{$card_setting['numcolor']}{/if}" onchange="$(this).setColor('.mc-number')" class="span7 color"></td>
            </tr>
            <tr>
                <th>商家兑换密码</th>
                <td><input type="text" name="pwd" id="pwd" value="{if !empty($card_setting['pwd'])}{$card_setting['pwd']}{/if}" class="span7"></td>
            </tr>
            <tr>
                <th>描述</th>
                <td><textarea style="height: 80px;" class="span7" cols="70" id="description"
                              name="description">{if !empty($card_setting['description'])}{$card_setting['description']}{/if}</textarea>
                </td>
            </tr>
            <script type="text/javascript">
                kindeditor($('#description'));
            </script>
            <tr>
            <tr>
                <th></th>
                <td>
                    <input name="submit" type="submit" value="提交" class="btn btn-sm btn-primary " />
                    <input type="hidden" name="token" value="{$_W['token']}" />
                </td>
            </tr>
        </table>

    </form>
</div>