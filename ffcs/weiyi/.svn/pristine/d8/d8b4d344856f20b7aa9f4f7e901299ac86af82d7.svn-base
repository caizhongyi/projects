{php $_W['breadcrumb'] = array(array('title'=>'营业厅统计'),array('title'=>'粉丝排行'))}
{template 'common/header'}
<div class="page-header">
    <h1>
        <i class="icon-book"></i> 粉丝排行
    </h1>
</div>

<div class="main">
    <div class="widget-box">
        <div class="widget-header">
            <h4>
                <i class="icon-search"></i> 搜索
            </h4>
        </div>
        <div class="widget-body">
            <div class="widget-main">{template 'fans_search'}</div>
        </div>
    </div>

    <div class="sub-item" id="table-list">
        <h4 class="header green"><i class="icon-list"></i>新增粉丝排行</h4>
        <div class="sub-item">
            <div class="sub-content" id="pv-trend"></div>
        </div>
        <!--
        <h4 class="header green"><i class="icon-list"></i>活跃用户趋势图</h4>
        <div class="sub-item">
            <div class="sub-content" id="uv-trend"></div>
        </div> -->

        <script type="text/javascript">
            $(function () { $("#pv-trend").highcharts({
                chart: {
                    renderTo: 'container',
                    type : "column",
                    borderWidth : 1,
                    backgroundColor:'#F3F3F3'
                },title :'',
                xAxis: {
                    categories: [{php echo implode(',', $tname)}]
                },
                yAxis: {
                    title:"",
                    type: 'logarithmic',
                    minorTickInterval: 1
                },
                legend: { align: 'right', x: -70, verticalAlign: 'top', y: 20, floating: true, backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColorSolid) || 'white', borderColor: '#CCC', borderWidth: 1, shadow: false },
                tooltip: { formatter: function() { return '<b>'+ this.x +'</b><br/>'+ this.series.name +': '+ this.y +'<br/>'+ 'Total: '+ this.point.stackTotal; } },
                plotOptions: { column: { stacking: 'normal', dataLabels: { enabled: true, color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white' } } },
                series: [{
                    name :'原粉丝量',
                    data: [{php echo implode(',', $tot)}],
                    dataLabels: {
                        enabled: true,
                        rotation: -30,
                        color: '#FFFFFF',
                        align: 'right',
                        x: 10,
                        y: 0,
                        style: {
                            fontSize: '15px',
                            fontFamily: 'Verdana, sans-serif',
                            textShadow: '0 0 3px black'
                        }
                    },
                    color: '#4572A7'
                },{
                    name : '新增量',
                    data: [{php echo implode(',', $cou)}],
                    dataLabels: {
                        enabled: true,
                        rotation: -30,
                        color: '#FFFFFF',
                        align: 'right',
                        x: 10,
                        y: 0,
                        style: {
                            fontSize: '15px',
                            fontFamily: 'Verdana, sans-serif',
                            textShadow: '0 0 3px black'
                        }
                    },
                    color: '#89A54E'
                }]
            }) });
        </script>
        <script type="text/javascript" src="./resource/script/highcharts.js"></script>
        <h4 class="header green"><i class="icon-list"></i>子账户统计</h4>
        <div class="sub-content">
            <table class="table table-striped table-bordered table-hover">
                <thead class="navbar-inner">
                <tr style="text-align: center;">
                    <th style="width: 30%; text-align: center;" class="row-hover">公众账号 </th>
                    <th style="text-align: center;">新增粉丝数 </th>
                    <th style="text-align: center;">总粉丝数 </th>
                    <th style="text-align: center;">所属用户 </th>
                </tr>
                </thead>
                <tbody>
                <!--
                <tr>
                    <td>-全部公众账号统计-</td><td>{$totalup}</td><td>{$totalsum}</td><td>-</td>
                </tr>-->
                {loop $list2 $lis}
                <tr>
                    <td>{$lis['tname']}</td>
                    <td>{php if($lis['cou']!=null) echo $lis['cou']; else echo '0';}</td>
                    <td>{$lis['total']}</td>
                    <td>{$lis['tuname']}</td>
                   <!-- <td>{$uv}</td> -->
                </tr>
                {/loop}
                </tbody>
            </table>
        </div>
        {$pager}
        <!-- 详细数据 end -->
    </div>
</div>

<script>
    $(function() {
        //详细数据相关操作
        var tdIndex;
        $("#table-list thead").delegate("th", "mouseover", function(){
            if($(this).find("i").hasClass("")) {
                $("#table-list thead th").each(function() {
                    if($(this).find("i").hasClass("icon-sort")) $(this).find("i").attr("class", "");
                });
                $("#table-list thead th").eq($(this).index()).find("i").addClass("icon-sort");
            }
        });
        $("#table-list thead th").click(function() {
            if($(this).find("i").length>0) {
                var a = $(this).find("i");
                if(a.hasClass("icon-sort") || a.hasClass("icon-caret-up")) { //递减排序
                    /*
                     数据处理代码位置
                     */
                    $("#table-list thead th i").attr("class", "");
                    a.addClass("icon-caret-down");
                } else if(a.hasClass("icon-caret-down")) { //递增排序
                    /*
                     数据处理代码位置
                     */
                    $("#table-list thead th i").attr("class", "");
                    a.addClass("icon-caret-up");
                }
                $("#table-list thead th,#table-list tbody:eq(0) td").removeClass("row-hover");
                $(this).addClass("row-hover");
                tdIndex = $(this).index();
                $("#table-list tbody:eq(0) tr").each(function() {
                    $(this).find("td").eq(tdIndex).addClass("row-hover");
                });
            }
        });
    });
</script>
{template 'common/footer'}
