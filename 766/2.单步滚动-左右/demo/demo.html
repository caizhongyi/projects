<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Demo step scroll</title>
<style type="text/css">
* { padding:0; margin:0; }

#JS-scroll, #JS-scroll2{ margin:20px auto; width:400px; overflow:hidden; position:relative; }
.con{ width:210px; height:163px; overflow:hidden; position:relative; }
.scroll{ position:absolute; width:100%; left:0; }
.item{ float:left; }

.page{ overflow:hidden; }
.goto{ float:left; width:20px; height:20px; line-height:20px; text-align:center; background:#ddd; }
.current{ background:#369; color:#fff; }
</style>
</head>
<body>
<div id="JS-scroll">
	<div class="con">
		<div class="scroll">
			<!--<div class="item"><img src="pic/thumb_01.jpg" alt="pic" /></div>-->
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80992/thumb_b_80992.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80984/thumb_b_80984.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80986/thumb_b_80986.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80976/thumb_b_80976.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80982/thumb_b_80982.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80971/thumb_b_80971.jpg" alt="pic" /></div>			
		</div>		
	</div>
	<div class="bar">
		<a href="#" class="left">左</a>
		<a href="#" class="right">右</a>
		<a href="#" class="door">Go</a>
		<div class="flag"><span class="curpage">1</span>/<span class="total">5</span></div>
	</div>
	<div class="page">
		<div class="goto current">1</div>
		<div class="goto">2</div>
		<div class="goto">3</div>
		<div class="goto">4</div>
		<div class="goto">5</div>
		<div class="goto">6</div>
	</div>
</div>

<div id="JS-scroll2">
	<div class="con">
		<div class="scroll">
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80992/thumb_b_80992.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80984/thumb_b_80984.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80986/thumb_b_80986.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80976/thumb_b_80976.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80982/thumb_b_80982.jpg" alt="pic" /></div>
			<div class="item"><img src="http://pic1.tu.178.com/thumb/27/80971/thumb_b_80971.jpg" alt="pic" /></div>			
		</div>		
	</div>
	<div class="bar">
		<a href="#" class="left">左</a>
		<a href="#" class="right">右</a>
		<a href="#" class="door">Stop</a>
		<!--<div class="flag"><span class="curpage">1</span>/<span class="total">5</span></div>-->
	</div>
	<div class="page">
		<div class="goto current">1</div>
		<div class="goto">2</div>
		<div class="goto">3</div>
		<div class="goto">4</div>
		<div class="goto">5</div>
		<div class="goto">6</div>
	</div>
</div>

<script type="text/javascript" src="http://js.olcdn.com/lib/utf8/jquery-1.4.4.min.js"></script>
<!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>-->
<script type="text/javascript">
/*
**	Author:	acedanny@qq.com
**	Date:	2012-05-02
**	Usefor:	A jQuery plugin for step scroll
*/
;(function($){
$.fn.alstepscroll = function(setting){
var defaults = {
	box:	'.scroll',	//box
	items:	'.item',	//scroll item
	flag:	'.flag',	//show flag
	current:'.curpage',	//current flag
	curClass:'current',	//当前类
	total:	'.total',	//total flag
	left:	'.left',	//left scroll
	right:	'.right',	//right scroll
	goto:	'.page',	//goto
	goItem:	'.goto',	//goto item
	doorItem:'.door',	//door obj
	//loop:	true,	//is loop
	play:	true,	//play or stop
	door:	true,	//stop or start animate
	isFlag:	true,	//is show flag
	stime:	3000,	//twice scroll separate time
	atime:	300	//scroll animate time
}
setting = $.extend({}, defaults, setting);
return this.each(function(){
	//variable init
	var	$obj = $(this),
		$box = $obj.find(setting.box),
		$item = $obj.find(setting.items),
		$current = $obj.find(setting.current),
		$total = $obj.find(setting.total),
		$left =	$obj.find(setting.left),
		$right = $obj.find(setting.right),
		length = $item.length,
		$step = $item.outerWidth(true),
		$door = $obj.find(setting.doorItem),
		flag = oflag = current = 1,
		timer = '',
		length2 = length + 2,
		$goto = $obj.find(setting.goto),
		$goItem = $obj.find(setting.goItem);
	//display flag
	if(setting.isFlag === true){
		$total.html(length);
		$current.html(flag);
	}
	//insert loop unit
	var html = [$item.eq(0)[0].outerHTML, $item.eq(length-1)[0].outerHTML];
	$box.prepend(html[1]);
	$box.append(html[0]);
	//state init
	$box.css({
		'width':length2*$step+'px',
		'left':'-'+$step+'px'
	});	
	//play
	var play = function(){
		$right.unbind('click');
		flag++;
		$box.animate({left:'-'+flag*$step+'px'},setting.atime,function(){
			if(flag >= length+1){
				flag = 1;
				$box.css('left','-'+$step+'px');
			}
			oflag = current = flag;
			//change flag
			if(setting.isFlag === true){
				$current.html(flag);
			}
			$goItem.removeClass(setting.curClass).eq(flag-1).addClass(setting.curClass);
			$right.bind('click',play);
		});
	}
	//oppsite play
	var oplay = function(){
		$left.unbind('click');
		oflag--;
		$box.animate({left:'-'+oflag*$step+'px'},setting.atime,function(){
			if(oflag <= 0){
				oflag = length;
				$box.css('left','-'+oflag*$step+'px');
			}
			flag = current = oflag;
			//change flag
			if(setting.isFlag === true){
				$current.html(oflag);
			}
			$goItem.removeClass(setting.curClass).eq(oflag-1).addClass(setting.curClass);
			$left.bind('click',oplay);
		});
	}
	//autoplay
	setInterval(function(){
		if(setting.play){
			play();
		}
	},setting.stime);
	//stop or start
	if(setting.door){
		$obj.mouseenter(function(){
			setting.play = false;
		}).mouseleave(function(){
			setting.play = true;
		});
	}
	//control
	$left.click(function(){
		oplay();
	});
	$right.click(function(){
		play();
	});	
	//goto
	$goItem.each(function(i,j){
		$(j).click(function(){			
			if($(j).hasClass(setting.curClass))return;
			else{
				flag = i+1;
				$current.html(flag);
				$goItem.removeClass(setting.curClass).eq(i).addClass(setting.curClass);
				$box.animate({left:'-'+flag*$step+'px'},setting.atime);	
			}
		});
	});	
	//start or stop
	$door.bind('click',function(){
		if(setting.door){
			setting.door = false;
			$door.html('Go');
			$obj.mouseenter(function(){
				setting.play = false;
			}).mouseleave(function(){
				setting.play = false;
			});
		}else{
			setting.door = true;
			$door.html('Stop');
			$obj.mouseenter(function(){
				setting.play = false;
			}).mouseleave(function(){
				setting.play = true;
			});
		}
	});
	//stop loop
});
}	
})(jQuery);
/*var $item = $(".item");
var html = [$item.eq(0)[0].outerHTML, $item.eq(length-1)[0].outerHTML];
alert(html.join("----"));*/
$("#JS-scroll").alstepscroll({door:false, play:false}); //
$("#JS-scroll2").alstepscroll({isFlag:false});
</script>
</body>
</html>
