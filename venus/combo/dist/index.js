!function(e){var t=function(n,r){this.options=e.extend(!0,{},t.DEFAULTS,r),this.$elem=e(n),this.init()};t.prototype={init:function(){this.create();var t=this;this.$elem.off("click.combo").on("click.combo",function(t){var n=this;t.stopPropagation(),e(document).off("click.combo").on("click.combo",function(){e(n).removeClass("active")}),e(this).toggleClass("active")}).on("click.combo","li",function(){t.set(e(this).attr("value"),e(this).html(),e(this).index())})},create:function(){if(this.$elem[0].tagName=="SELECT"){var t=e('<span class="combo"></span>'),n=e('<a href="javascript:;" class="combo-icon"></a>');this.$val=e('<span class="combo-val"></span>').appendTo(t),n.appendTo(t),this.$panel=e('<div class="combo-panel"></div>').appendTo(t),this.$ori=this.$elem,this.$elem=t.insertAfter(this.$ori.hide());var r=e("<ul>"),i="",s=-1;this.$ori.find("option").each(function(){var t=e("<li>").html(e(this).html()).attr("value",e(this).attr("value"));e(this).prop("selected")&&(i=e(this).html(),s=e(this).index()),r.append(t)}),this.$panel.append(r),this.set(this.$ori.val(),i,s)}else{this.$val=this.$elem.find(".combo-val"),this.$panel=this.$elem.find(".combo-panel");var o=this.$elem.find("[name="+e(this).attr("name")+"]");this.$ori=o.length?o:e('<input type="hidden" name="'+this.$elem.attr("name")+'">').appendTo(this.$elem),this.$elem.removeAttr("name")}},set:function(t,n,r){return this.$val.html(n),this.$ori.val(t),this.$panel.find("li").removeAttr("selected").eq(r).attr("selected","selected"),this.$elem.trigger(e.Event("change",{value:t,index:r,text:n})),this.$ori.trigger("change"),this},get:function(){return{val:this.$ori.val(),text:this.$val.html()}},index:function(e){if(typeof e=="number"){var t=this.$panel.find("li").eq(e);return this.set(t.attr("value"),t.html(),t.index()),this}return this.$panel.find("li[selected]").index()},panelPos:function(){this.$panel.appendTo("body")}},t.DEFAULTS={index:-1},e.fn.combo=function(n){var r=arguments;return e(this).each(function(){var i=e(this).data("collapse");i||(i=new t(this,n),e(this).data("collapse",i));var s=[];for(var o=1;o<r.length;o++)s.push(r[o]);var u=new Function("data","options","return data[ options ]("+s.join(",")+")");n&&i[n]&&u(i,n)})},e.fn.combo.Constructor=t}(window.jQuery||require("jquery"))
