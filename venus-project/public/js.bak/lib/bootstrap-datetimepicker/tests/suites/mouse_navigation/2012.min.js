module("Mouse Navigation 2012",{setup:function(){this.input=$('<input type="text" value="31-03-2012">').appendTo("#qunit-fixture").datetimepicker({format:"dd-mm-yyyy",viewSelect:2}).focus();this.dp=this.input.data("datetimepicker");this.picker=this.dp.picker},teardown:function(){this.picker.remove()}});test("Selecting date resets viewDate and date",function(){var a;equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days tbody td:nth(7)");equal(a.text(),"4");a.click();datesEqual(this.dp.viewDate,UTCDate(2012,2,4));datesEqual(this.dp.date,UTCDate(2012,2,4));a=this.picker.find(".datetimepicker-days tbody td:first");equal(a.text(),"26")});test("Navigating next/prev by month",function(){var a;equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days thead th.prev");ok(a.is(":visible"),"Month:prev nav is visible");a.click();datesEqual(this.dp.viewDate,UTCDate(2012,1,29));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-days tbody td:first");equal(a.text(),"29");a=this.picker.find(".datetimepicker-days thead th.next");ok(a.is(":visible"),"Month:next nav is visible");a.click().click();datesEqual(this.dp.viewDate,UTCDate(2012,3,29));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-days tbody td:first");equal(a.text(),"25")});test("Navigating to/from year view",function(){var a;equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days thead th.switch");ok(a.is(":visible"),"View switcher is visible");a.click();ok(this.picker.find(".datetimepicker-months").is(":visible"),"Month picker is visible");equal(this.dp.viewMode,3);datesEqual(this.dp.viewDate,UTCDate(2012,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-months tbody span:contains(Apr)");a.click();equal(this.dp.viewMode,2);datesEqual(this.dp.viewDate,UTCDate(2012,3,1));datesEqual(this.dp.date,UTCDate(2012,2,31))});test("Navigating to/from decade view",function(){var a;equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days thead th.switch");ok(a.is(":visible"),"View switcher is visible");a.click();ok(this.picker.find(".datetimepicker-months").is(":visible"),"Month picker is visible");equal(this.dp.viewMode,3);datesEqual(this.dp.viewDate,UTCDate(2012,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-months thead th.switch");ok(a.is(":visible"),"View switcher is visible");a.click();ok(this.picker.find(".datetimepicker-years").is(":visible"),"Year picker is visible");equal(this.dp.viewMode,4);datesEqual(this.dp.viewDate,UTCDate(2012,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-years tbody span:contains(2011)");a.click();equal(this.dp.viewMode,3);datesEqual(this.dp.viewDate,UTCDate(2011,2,1));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-months tbody span:contains(Apr)");a.click();equal(this.dp.viewMode,2);datesEqual(this.dp.viewDate,UTCDate(2011,3,1));datesEqual(this.dp.date,UTCDate(2012,2,31))});test("Navigating prev/next in year view",function(){var a;equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days thead th.switch");ok(a.is(":visible"),"View switcher is visible");a.click();ok(this.picker.find(".datetimepicker-months").is(":visible"),"Month picker is visible");equal(this.dp.viewMode,3);equal(this.picker.find(".datetimepicker-months thead th.switch").text(),"2012");datesEqual(this.dp.viewDate,UTCDate(2012,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-months thead th.next");a.click();equal(this.picker.find(".datetimepicker-months thead th.switch").text(),"2013");datesEqual(this.dp.viewDate,UTCDate(2013,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-months thead th.prev");a.click().click();equal(this.picker.find(".datetimepicker-months thead th.switch").text(),"2011");datesEqual(this.dp.viewDate,UTCDate(2011,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31))});test("Navigating prev/next in decade view",function(){var a;equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days thead th.switch");ok(a.is(":visible"),"View switcher is visible");a.click();ok(this.picker.find(".datetimepicker-months").is(":visible"),"Month picker is visible");equal(this.dp.viewMode,3);datesEqual(this.dp.viewDate,UTCDate(2012,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-months thead th.switch");ok(a.is(":visible"),"View switcher is visible");a.click();ok(this.picker.find(".datetimepicker-years").is(":visible"),"Year picker is visible");equal(this.dp.viewMode,4);equal(this.picker.find(".datetimepicker-years thead th.switch").text(),"2010-2019");datesEqual(this.dp.viewDate,UTCDate(2012,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-years thead th.next");a.click();equal(this.picker.find(".datetimepicker-years thead th.switch").text(),"2020-2029");datesEqual(this.dp.viewDate,UTCDate(2022,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31));a=this.picker.find(".datetimepicker-years thead th.prev");a.click().click();equal(this.picker.find(".datetimepicker-years thead th.switch").text(),"2000-2009");datesEqual(this.dp.viewDate,UTCDate(2002,2,31));datesEqual(this.dp.date,UTCDate(2012,2,31))});test("Selecting date from previous month resets viewDate and date, changing month displayed",function(){var a;equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days tbody td:first");equal(a.text(),"26");equal(this.picker.find(".datetimepicker-days thead th.switch").text(),"March 2012");a.click();equal(this.picker.find(".datetimepicker-days thead th.switch").text(),"February 2012");datesEqual(this.dp.viewDate,UTCDate(2012,1,26));datesEqual(this.dp.date,UTCDate(2012,1,26));a=this.picker.find(".datetimepicker-days tbody td:first");equal(a.text(),"29")});test("Selecting date from next month resets viewDate and date, changing month displayed",function(){var a;this.input.val("01-04-2012");this.dp.update();equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days tbody td:last");equal(a.text(),"5");equal(this.picker.find(".datetimepicker-days thead th.switch").text(),"April 2012");a.click();equal(this.picker.find(".datetimepicker-days thead th.switch").text(),"May 2012");datesEqual(this.dp.viewDate,UTCDate(2012,4,5));datesEqual(this.dp.date,UTCDate(2012,4,5));a=this.picker.find(".datetimepicker-days tbody td:first");equal(a.text(),"29")});test("Selecting date from next month when the current month has 31 days resets viewDate and date, changing month displayed to the following month",function(){var a;this.dp.viewSelect=0;this.input.val("2012-01-31");this.dp.update();equal(this.picker.find(".datetimepicker-days tbody td.day.active").text(),"31");equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days tbody td:last");equal(a.text(),"4");equal(this.picker.find(".datetimepicker-days thead th.switch").text(),"January 2012");a.click();equal(this.picker.find(".datetimepicker-days thead th.switch").text(),"February 2012");datesEqual(this.dp.viewDate,UTCDate(2012,1,4))});test("Selecting date from previous month when the current month has 31 days resets viewDate and date, changing month displayed to the preceding month",function(){var a;this.dp.viewSelect=0;this.input.val("2012-03-31");this.dp.update();equal(this.picker.find(".datetimepicker-days tbody td.day.active").text(),"31");equal(this.dp.viewMode,2);a=this.picker.find(".datetimepicker-days tbody td.old:last");equal(a.text(),"29");equal(this.picker.find(".datetimepicker-days thead th.switch").text(),"March 2012");a.click();equal(this.picker.find(".datetimepicker-days thead th.switch").text(),"February 2012");datesEqual(this.dp.viewDate,UTCDate(2012,1,29))});