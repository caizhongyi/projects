<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>..\node_modules\alienjs\src\index.bak.js - SmartDoc</title>
  
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-smart">
 <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
               <a class="navbar-brand mainlogo" href="https://github.com/zhh77/smartdoc">
             
            <img alt="SmartDoc" src="../assets/css/logo.png" title="SmartDoc">
            
                SmartDoc
          </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                 <ul class="nav navbar-nav">
                    
                    <li><a href="https://github.com/zhh77/smartdoc">Home</a>
                    </li>
                    
                    <li><a href="/">Document</a>
                    </li>
                    
                    <li><a href="https://github.com/zhh77/smartdoc">About</a>
                    </li>
                    
                </ul>
               <div class="navbar-form navbar-right filterAPi" autocomplete="off">
                <input type="text" id='txtSearchAPI' class="form-control search-query" placeholder="Search for API" />
                 <ul id="filterList" class="filterItems dropdown-menu" role="menu"></ul>
                </div>
            </div>
        </div>
    </nav>
    <div id="sidebar">
    <h3>Modules/Classes</h3>
        <div id="api-tabview-filter">
            <input id='txtSearch' type="search" class="form-control" placeholder="Type to filter Modules/Classes">
        </div>
        <dl id="sidebar_list">
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/273.html">273</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/alienjs.html">alienjs</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/window.require.html">window.require</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Countdown.html">Countdown</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/Date.html">Date</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/jquery.html">jquery</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/jquery.transitionEnd.html">jquery.transitionEnd</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.support.transition.html">jquery.support.transition</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.animationEnd.html">jquery.animationEnd</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/jquery-ui.html">jquery-ui</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/jquery.ajaxPanel.html">jquery.ajaxPanel</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.dialog.html">jquery.dialog</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Array.html">Array</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.browserLowVersion.html">jquery.browserLowVersion</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.confirm.html">jquery.confirm</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.alert.html">jquery.alert</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ng.html">ng</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/EventEmitter Manages event registering and emitting..html">EventEmitter Manages event registering and emitting.</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ngMock.html">ngMock</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ngMockE2E.html">ngMockE2E</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ui.html">ui</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/AjaxPanel.html">AjaxPanel</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Date.Dialog.html">Date.Dialog</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/WebUploader.html">WebUploader</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Base.html">Base</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Mediator.html">Mediator</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/options.Uploader.html">options.Uploader</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/File.File.html">File.File</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/File.Queue.html">File.Queue</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Uploader.html">Uploader</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/window.html">window</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
        </dl>
</div>
   
    <div class="stdoc-content">
        <!--     <form id="options-form" class="form-inline pull-right">
        Show:
        <label for="api-show-inherited" class="checkbox">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected" class="checkbox">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private" class="checkbox">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated" class="checkbox">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </form>

 -->
        <div class="apidocs">
            <div id="docs-main">
                <div class="content">
                    <div class="page-header">
    <h1>..\node_modules\alienjs\src\index.bak.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums" id='src_code'>
/**
 * @descrption js文件加载
 * @dependencies  Deferred.js , Ajax.js
 * http://www.alienjs.net
 * */


!(function( window ){
    var Ajax = function(){
        this.deferred = window.Deferred &amp;&amp; Deferred();
        this.XMLHttpReq = null;
    }

    Ajax.prototype.createXMLHttpRequest = function(){
        try {
            this.XMLHttpReq = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);//IE高版本创建XMLHTTP
        }
        catch(E) {
            try {
                this.XMLHttpReq  = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);//IE低版本创建XMLHTTP
            }
            catch(E) {
                this.XMLHttpReq  = new XMLHttpRequest();//兼容非IE浏览器，直接创建XMLHTTP对象
            }
        }
        return this;
    }
    Ajax.prototype.get = function( url , callback  , sync  ){
            return this.sendAjaxRequest( url ,&#x27;get&#x27;, callback  , sync  )
        }
        Ajax.prototype.post = function( url , callback  , sync  ){
            return this.sendAjaxRequest( url ,&#x27;post&#x27;, callback  , sync  )
        }
        Ajax.prototype.error = function( XMLHttpReq , readyState , status){
        }
        Ajax.prototype.sendAjaxRequest = function( url ,type , callback , sync  ){
            var ajax = this.createXMLHttpRequest();      //创建XMLHttpRequest对象
            var XMLHttpReq = this.XMLHttpReq;
            XMLHttpReq.open( type || &#x27;post&#x27; , url, sync == null ?  true : sync );
        XMLHttpReq.onreadystatechange = function(){
            if (XMLHttpReq.readyState == 4) {
                if (XMLHttpReq.status == 200) {
                    callback &amp;&amp; callback.call( this , XMLHttpReq.responseText );
                    this.deferred ?  this.deferred.resolveWith( XMLHttpReq.responseText ) : this;
                }
                else{
                    ajax.error.call( this ,XMLHttpReq ,XMLHttpReq.readyState ,XMLHttpReq.status);
                    this.deferred ?  this.deferred.rejectWith(XMLHttpReq ,XMLHttpReq.readyState ,XMLHttpReq.status) : this;
                }
            }
            else{
                ajax.error.call( this ,XMLHttpReq ,XMLHttpReq.readyState ,XMLHttpReq.status);
                this.deferred ?  this.deferred.rejectWith(XMLHttpReq ,XMLHttpReq.readyState ,XMLHttpReq.status) : this;
            }
        }; //指定响应函数
        XMLHttpReq.send(null);
        return this.deferred ?  this.deferred.promise() : this;
    }

    window.Ajax = Ajax;

})( window);

;(function ( window ) {

    var ajs = function(){
        this.modules = {
            deferred : Deferred(),
            items : []
        }
        this.ajax = new Ajax() ;
        this.type = &quot;link&quot; ;

        var js = document.scripts;
        this.root = js[js.length-1].src.substring(0,js[js.length-1].src.lastIndexOf(&quot;/&quot;)+1);
        this.init();
    }

    ajs.prototype = {
        init : function(){
            this.ajax.get( this.root + &#x27;package.json&#x27; , function( data ){
                var data = new Function(&#x27;return &#x27; + data )();
            }, false) ;
           // this.ajax.get(&#x27;&#x27;);
        },
        _ext : function( url ){
            return url.substring( url.lastIndexOf(&#x27;.&#x27;) + 1);
        },
        _script : function(src){
            var script = document.createElement( &#x27;script&#x27; );
            script.type = &quot;text/javascript&quot;;
            script.charset =&#x27;utf-8&#x27;;
            script.src = src;
            return script ;
        },
        _swf : function( url , options ){
            options = options || {};
            var opts = {
                width : options.width || 500 ,
                height : options.height || 400 ,
                src : options.src ,
                wmode : options.wmode || &#x27;transparent&#x27; ,
                quality : options.quality || &#x27;high&#x27; ,
                name : options.name || &#x27;&#x27; ,
                allowScriptAccess : options.allowScriptAccess || &#x27;sameDomain&#x27;
            }

            var html = &#x27;&lt;object classid=&quot;&quot; codebase=&quot;&quot; width=&quot;&#x27; + opts.width + &#x27;&quot;    height=&quot;&#x27; + opts.height + &#x27;&quot;  align=&quot;middle&quot;&gt;&#x27;;
            html +=&#x27;&lt;param name=&quot;movie&quot; value=&quot;&#x27; + url + &#x27;&quot; /&gt;&#x27;;
            html +=&#x27;&lt;param name=&quot;quality&quot; value=&quot;&#x27; + opts.quality + &#x27;&quot; /&gt;&#x27;;
            html +=&#x27;&lt;param name=&quot;wmode&quot; value=&quot;&#x27; + opts.wmode + &#x27;&quot; /&gt;&#x27;;
            html +=&#x27;&lt;embed src=&quot;&#x27; + url + &#x27;&quot; quality=&quot;&#x27; + opts.quality + &#x27;&quot; wmode=&quot;&#x27; + opts.wmode + &#x27;&quot; width=&quot;&#x27; + opts.width + &#x27;&quot;  height=&quot;&#x27; + opts.height + &#x27;&quot; name=&quot;&#x27; + opts.name + &#x27;&quot; align=&quot;middle&quot; allowScriptAccess=&quot;&#x27; + opts.allowScriptAccess + &#x27;&quot;  type=&quot;application/x-shockwave-flash&quot; pluginspage=&quot;http://www.macromedia.com/go/getflashplayer&quot; /&gt;&#x27;;
            html +=&#x27;&lt;/object&gt;&#x27;;

            var span = document.createElement( &#x27;span&#x27; );
            span.innerHTML = html;
            return span;
        },
        _css : function( href ){
            var csslink = document.createElement( &#x27;link&#x27; );
            csslink.type = &#x27;text/css&#x27;;
            csslink.rel = &quot;stylesheet&quot;;
            csslink.charset = &#x27;utf-8&#x27;;
            csslink.href = href;
            return csslink ;
        },
        _checkResolve : function( dependencies ){
            if( !dependencies ) return true ;
            for( var i = 0 ; i &lt; dependencies.length; i ++ ){
                if( this.modules.items[dependencies[i]] ){
                    if(this.modules.items[dependencies[i]].deferred.state() != &#x27;resolved&#x27;) {
                        return false;
                    }
                    else{
                        return true;
                    }
                }
                else{
                    this.load({
                        id : dependencies[i],
                        deferred : Deferred(),
                        dependencies : null
                    });
                }

            }
            return true;
        },
        _checkModulesResolve : function(){
            var items = this.modules.items;
            for( var i = 0 ; i &lt; items.length; i ++ ){
                if(items[i].deferred.state() != &#x27;resolved&#x27;) {
                    return false;
                }
            }
            return true;
        },
        combo : function( url ){
            var js = [], css = [], jsData =  url + &quot;??path=&quot; + this.root, cssData = url + &quot;??path=&quot; + this.root;
            for(var i= 0 ; i &lt; this.modules.length ; i ++ ){
                if( this._ext( this.modules.id ) == &#x27;js&#x27; )
                    js.push( this.modules.id );
                else if(this._ext( this.modules.id ) == &#x27;css&#x27; )
                    css.push( this.modules.id );
            }

            if(js.length){
                jsData += &quot;&amp;modules=&quot; + js.join(&#x27;,&#x27;);
                document.body.appendChild( this._script(jsData))
            }

            if(js.length){
                cssData += &quot;&amp;modules=&quot; + css.join(&#x27;,&#x27;);
                document.head.appendChild( this._css(cssData))
            }

            return this;
        },
        addModule : function( module ){
            return  this.modules.push( module );
        },
        ajaxLoad : function( module  , callback ){
            var done  = false;
            this.ajax.get( module.id , function( data ){
                if ( !done ){
                    done = true;
                    if( !/^define\(/.test(data)){

                        var dependencies = data.match(/require\(.*\)/g) || [] ;

                        for(var i = 0 ; i &lt; dependencies.length ; i++){
                            dependencies[i] = dependencies[i].replace(&#x27;require(\&#x27;&#x27;,&quot;&quot;).replace(&#x27;\&#x27;)&#x27;,&quot;&quot;)
                        }
                        module.dependencies = dependencies;

                        dependencies = dependencies.length ? &#x27;[&quot;&#x27;+ dependencies.join(&#x27;&quot;,&quot;&#x27;) + &#x27;&quot;]&#x27; : &#x27;[]&#x27; ;
                        data = &#x27;define(&quot;&#x27;+ module.id +&#x27;&quot;,&#x27;+ dependencies  +&#x27;,function( require , exports , module ){\n &#x27; + data + &#x27;; \n});&#x27;
                    }
                    var fn = new Function(data);
                    fn();
                    callback &amp;&amp; callback.call( this );
                }

            });

        },
        load : function( module , callback , type ){
            var domscript,e = this._ext(module.id), self =  this;

            var type = type || this.type;

            if( e == &#x27;js&#x27; &amp;&amp; type == &#x27;get&#x27;){
                this.ajaxLoad(function(){
                    onload.call( this );
                });
            }
            else{
                switch ( e ){
                    case  &#x27;css&#x27; : domscript = this._css(module.id); break;
                    case  &#x27;js&#x27; : domscript = this._script(module.id); break;
                    case  &#x27;swf&#x27; : domscript = this._swf(module.id ); break;
                }
                document.body.appendChild( domscript );
                domscript.doneState = { loaded : true , complete : true};

                if ( domscript.onreadystatechange !== undefined ) {
                    // IE6+ support, chrome, firefox not support
                    domscript.onreadystatechange = function () {
                        if ( domscript.doneState[domscript.readyState] ) {
                            onload.call( this );
                        }
                        else{
                            error();
                        }
                    }
                }
                else {
                    // IE9+, chrome, firefox support
                    domscript.onload = function(){
                        onload.call(this)
                    } ;
                }
                domscript.onerror = function(){
                    error();
                }
            }

            var onload = function(){
                module.deferred.resolveWith();
                if(self._checkModulesResolve()){
                    self.modules.deferred.resolveWith();
                    callback &amp;&amp; callback.call( this );
                }
            }

            var error = function(){
                module.deferred.rejectWith();
                self.modules.deferred.rejectWith();
            }
            this.modules.items.push( module );

            return  module.deferred ;
        },
        use : function( src , dependencies , callback , type){

            if( typeof dependencies == &#x27;function&#x27; ){
                type = callback;
                callback = dependencies;
                dependencies = null ;
            }

            if(this._checkResolve(dependencies)){
                if( typeof  src == &#x27;object&#x27;){
                    for(var i = 0; i &lt; src.length ; i ++){
                        this.load.call( this , {
                            id : src[i],
                            deferred : Deferred(),
                            dependencies : dependencies
                        },callback , type )
                    }
                }
                else{
                    this.load.call(this ,{
                        id : src,
                        deferred : Deferred(),
                        dependencies : dependencies
                    }, callback  , type )
                }
            }
            return this.modules.deferred.promise();
        },
        usejQuery : function(){
            return !window.jQuery &amp;&amp; this.use( &quot;http://ajax.googleapis.com/ajax/libs/jquery/&quot; + ( &#x27;1.7.2&#x27;) + &quot;/jquery.min.js&quot;);
        }
    }

    var alienjs = new ajs();
    /**  *********************************** */

    var js = document.scripts;
    var root = js[js.length-1].src.substring(0,js[js.length-1].src.lastIndexOf(&quot;/&quot;)+1);
    var config ;


    var ext = function (url){
        return url.substring( url.lastIndexOf(&#x27;.&#x27;) + 1);
    }

    function addLoadEvent(func){
//将函数作为参数，此函数就是 onload 触发时需要执行的某个函数
        var oldonload=window.onload;
        //将原来的 onload 的值赋给临时变量 oldonload。
        if(typeof window.onload!=&quot;function&quot;){
            //判断 onload 的类型是否是 function。如果已经执行window.onload=function(){...} 赋值，那么此时 onload 的类型就是 function
            //否，则说明 onload 还没有被赋值，当前任务 func 为第一个加入的任务
            window.onload=func();
            //作为第一个任务，给 onload 赋值
        }else{
            //是，则说明 onload 已被赋值，onload 中先前已有任务加入
            window.onload=function(){
                oldonload();
                func();
                //作为后续任务，追加到先前的任务后面
            }
        }
    }

    new Ajax().get( root + &#x27;package.json&#x27; , function( data ){
        var data = new Function(&#x27;return &#x27; + data )();
        config = data ;
        if( data.combo.open ){
                var js = [], css = [], jsData =   data.combo.url + &quot;??path=&quot; + root , cssData =  data.combo.url + &quot;??path=&quot; + root ;

                for( var i in data.dependencies ){
                    if( ext( data.dependencies[i] ) == &#x27;js&#x27; )
                        js.push( data.dependencies[i] );
                    else if( ext( data.dependencies[i]) == &#x27;css&#x27; )
                        css.push( data.dependencies[i] );
                }

                if(css.length){
                    cssData += &quot;&amp;modules=&quot; + css.join(&#x27;,&#x27;);
                    var csslink = document.createElement( &#x27;link&#x27; );
                    csslink.type = &#x27;text/css&#x27;;
                    csslink.rel = &quot;stylesheet&quot;;
                    csslink.charset = &#x27;utf-8&#x27;;
                    csslink.href = cssData;
                    document.head.appendChild( csslink )
                }


                if(js.length){
                    jsData += &quot;&amp;modules=&quot; + js.join(&#x27;,&#x27;);
                    var script = document.createElement( &#x27;script&#x27; );
                    script.type = &quot;text/javascript&quot;;
                    script.charset =&#x27;utf-8&#x27;;
                    script.src = jsData;
                    document.head.appendChild( script )
                }

                return this;
            }

    }, false) ;

    var Module = function( options ){
        options = options || {};
        return {
            id : options.id ,
            deferred : Deferred(),
            dependencies : options.dependencies || []
        }
    }

    var modules = {} ;

    /**
     * require 方法
     * @class require
     * @module alienjs
     * @namespace window
     * @param url {string} 引入地址
     */
    window.require = function( url ){
        var module = new Module({
            id : url
        });

        if( !modules[ url ] &amp;&amp; !config.combo.open )
            new Ajax().get( url , function( data ){
              /*  if( !/^define\(/.test(data)){

                    var dependencies = data.match(/require\(.*\)/g) || [] ;

                    for(var i = 0 ; i &lt; dependencies.length ; i++){
                        dependencies[i] = dependencies[i].replace(&#x27;require(\&#x27;&#x27;,&quot;&quot;).replace(&#x27;\&#x27;)&#x27;,&quot;&quot;)
                    }
                    module.dependencies = dependencies;

                   // dependencies = dependencies.length ? &#x27;[&quot;&#x27;+ dependencies.join(&#x27;&quot;,&quot;&#x27;) + &#x27;&quot;]&#x27; : &#x27;[]&#x27; ;
                }*/
                data = &#x27;define(&quot;&#x27;+ module.id +&#x27;&quot;,function( exports ,module ){\n &#x27; + data + &#x27;;  return exports = module.exports; \n;})&#x27;
                var fn = new Function( data );
                fn();
                module.exports = modules[url]( module.exports , module );
                //modules[module.id] = module ;

            } , false );
        else
            module.exports = modules[url]( module.exports , module );

        return module.exports;
    }

    window.define = function( id , fn ){
        modules[id] = fn ;
    }

    window.Alienjs = alienjs;

})( window );

    </pre>
</div>

                </div>
            </div>
        </div>
    </div>
<a id="gotoTop" class='well well-small' href='#'>
    Top
</a>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/config.js"></script>
<script src="../assets/js/doc.js"></script>
</body>
</html>
