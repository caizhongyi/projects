<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>..\node_modules\alienjs-validator\src\index.js - SmartDoc</title>
  
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-smart">
 <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
               <a class="navbar-brand mainlogo" href="https://github.com/zhh77/smartdoc">
             
            <img alt="SmartDoc" src="../assets/css/logo.png" title="SmartDoc">
            
                SmartDoc
          </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                 <ul class="nav navbar-nav">
                    
                    <li><a href="https://github.com/zhh77/smartdoc">Home</a>
                    </li>
                    
                    <li><a href="/">Document</a>
                    </li>
                    
                    <li><a href="https://github.com/zhh77/smartdoc">About</a>
                    </li>
                    
                </ul>
               <div class="navbar-form navbar-right filterAPi" autocomplete="off">
                <input type="text" id='txtSearchAPI' class="form-control search-query" placeholder="Search for API" />
                 <ul id="filterList" class="filterItems dropdown-menu" role="menu"></ul>
                </div>
            </div>
        </div>
    </nav>
    <div id="sidebar">
    <h3>Modules/Classes</h3>
        <div id="api-tabview-filter">
            <input id='txtSearch' type="search" class="form-control" placeholder="Type to filter Modules/Classes">
        </div>
        <dl id="sidebar_list">
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/273.html">273</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/alienjs.html">alienjs</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/window.require.html">window.require</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Countdown.html">Countdown</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/Date.html">Date</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/jquery.html">jquery</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/jquery.transitionEnd.html">jquery.transitionEnd</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.support.transition.html">jquery.support.transition</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.animationEnd.html">jquery.animationEnd</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/jquery-ui.html">jquery-ui</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/jquery.ajaxPanel.html">jquery.ajaxPanel</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.dialog.html">jquery.dialog</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Array.html">Array</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.browserLowVersion.html">jquery.browserLowVersion</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.confirm.html">jquery.confirm</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.alert.html">jquery.alert</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ng.html">ng</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/EventEmitter Manages event registering and emitting..html">EventEmitter Manages event registering and emitting.</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ngMock.html">ngMock</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ngMockE2E.html">ngMockE2E</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ui.html">ui</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/AjaxPanel.html">AjaxPanel</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Date.Dialog.html">Date.Dialog</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/WebUploader.html">WebUploader</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Base.html">Base</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Mediator.html">Mediator</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/options.Uploader.html">options.Uploader</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/File.File.html">File.File</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/File.Queue.html">File.Queue</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Uploader.html">Uploader</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/window.html">window</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
        </dl>
</div>
   
    <div class="stdoc-content">
        <!--     <form id="options-form" class="form-inline pull-right">
        Show:
        <label for="api-show-inherited" class="checkbox">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected" class="checkbox">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private" class="checkbox">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated" class="checkbox">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </form>

 -->
        <div class="apidocs">
            <div id="docs-main">
                <div class="content">
                    <div class="page-header">
    <h1>..\node_modules\alienjs-validator\src\index.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums" id='src_code'>
!(function ($) {
    /***
     * 初始化验证
     * @param options
     * @returns {*|jQuery}
     */
    var Validator = function( selector , options ){
        this.options = $.extend(true, {}, Validator.DEFAULTS , options);
        this.$elem = $(selector);
        for( var i in this.options){
            this.options[i] = this.$elem.data(i.replace(/[A-Z]+/,&#x27;-$&amp;&#x27;).toLowerCase()) ||  this.options[i];
        }
        this.init();
    }

    Validator.prototype = {
        init : function(){
             this.deferred = $.Deferred();
             this.fields = {};
             this.rules = Validator.rules;

            this.$elem.attr(&#x27;novalidate&#x27;,true);
            this.registerEvent()
                .addAttrParams()
                .bindEvent()
                .getFields()

            return this;
        },
        error   : function( field ){
            return this.tip( field , &#x27;error&#x27; )
        },
        required   : function( field ){
            return this.tip( field , &#x27;required&#x27; )
        },
        compared   : function( field ){
            return this.tip( field , &#x27;compared&#x27; )
        },
        correct : function( field ){
            return this.tip( field , &#x27;correct&#x27; )
        },
        message : function( field ){
            return this.tip( field , &#x27;message&#x27; )
        },
        tip : function( field , status ){
            var name = field ;
            var $elem = $(&#x27;[name=&#x27;+ name +&#x27;]&#x27; , this.$elem ) ;
            var $tip = $($elem.data(&#x27;tip&#x27;) || ( name + &#x27;-tip&#x27;));
            var errorClass = &#x27;text-&#x27; + this.options.errorClass;
            var correctClass = &#x27;text-&#x27; + this.options.correctClass;
            var correctInputClass = &#x27;input-&#x27; + this.options.correctClass;
            var errorInputClass  = &#x27;input-&#x27; + this.options.correctClass;
            $tip.html( this.rules[ name ][ status ] ).removeClass( errorClass).removeClass( correctClass );
            $elem.removeClass( correctInputClass ).removeClass( errorInputClass );
            switch (status){
                    case &#x27;correct&#x27;: $tip.addClass( correctClass ) ; $elem.addClass( correctInputClass ) ;break;
                case &#x27;error&#x27;:case &#x27;required&#x27;:case &#x27;compared&#x27;: $tip.addClass( errorClass ) ; $elem.addClass( errorInputClass ) ;break;
                default :  break;
            }
            return this;
        },
        validateField : function( field ){

            var $elem = $(&#x27;[name=&#x27;+ field +&#x27;]&#x27; , this.$elem ) ;
            if( $elem.attr(&#x27;novalidate&#x27;) ) return true;

            if( !this.rules[ field ]){
                this.rules[field] = { }
            }

            if( $elem.attr(&#x27;required&#x27;) &amp;&amp; $elem.val() == &#x27;&#x27; ){
                this.required( field );
                this.fields[ field].deferred.rejectWith();
                return false;
            }

            if( $elem.attr(&#x27;compared&#x27;) &amp;&amp; $.trim($($elem.attr(&#x27;compared&#x27;)).val()) != $.trim($elem.val())){
                this.compared( field );
                this.fields[ field].deferred.rejectWith();
                return false;
            }

            var valid = this.rules[ field ].valid, validRes = false;
            if( typeof  valid == &#x27;function&#x27;){
                validRes = valid(  $elem.val() );
            }
            else{
                validRes = new RegExp(valid).test(  $elem.val() );
            }

            if( !validRes ){
                this.error( field );
                this.fields[ field].deferred.rejectWith();
                return false;
            }

            this.correct( field );
            this.fields[ field].deferred.resolveWith();
            return true;
        },
        validate : function(){
            for(var i in this.fields){
                if( this.validateField(i) ){
                    this.deferred.resolveWith();
                }
                else{
                    this.deferred.rejectWith();
                    return this.deferred.promise();
                }
            }
            return this.deferred.promise();
        },
        getFields : function(){
            var self = this;
            this.$elem.find(&#x27;[name]&#x27;).each(function(){
                var name = $(this).attr(&#x27;name&#x27;) ;
                self.fields[ name ] = {
                    name : name,
                    deferred : $.Deferred()
                }
                $(this).off(&#x27;blur.validator&#x27;).on(&#x27;blur.validator&#x27;,function(){
                    self.validateField( name );
                }).off(&#x27;focus.validator&#x27;).on(&#x27;focus.validator&#x27;,function(){
                    self.message( name );
                })
                self.addFieldAttr( this , name )
            })
            return this;
        },
        bindEvent : function(){
            var self = this;
            this.$elem.off(&#x27;submit.validator&#x27;).on(&#x27;submit.validator&#x27;,function(){
                var res = false;
                self.validate()
                    .done(function(){
                        res = true;
                    })
                    .fail(function(){
                        res = false;
                    })
                console.log(self.deferred.state());
                return false;
            })
            return this;
        },
        addFieldAttr : function( selector , field ){
            var datas = $(selector).data();

            if( !this.rules[field] )  this.rules[field] = {};

            for(var i in datas ){
                this.rules[field][i] = datas[i.toLowerCase()] || this.rules[field] [i];
            }

            this.rules[ field ][&#x27;valid&#x27;] = $(selector).attr(&#x27;pattern&#x27;) || this.rules[ field ][&#x27;valid&#x27;];
            return this;
        },
        addAttrParams : function(){
            for(var i in this.options){
                this.options[i] = this.$elem.data( i.toLowerCase() ) || this.options[i];
            }
            return this;
        },
        registerEvent : function(){
            // TODO 注册事件
            var events = [ &#x27;on&#x27; , &#x27;off&#x27; , &#x27;trigger&#x27; ];
            for(var i = 0 ; i &lt; events.length; i ++){
                var e = events[i];
                this[e] = (function(e){
                    return function(){
                        // arguments 为传入参数
                        self.$elem[e].apply(  self.$elem , arguments );
                        return self;
                    }
                })( e );
            }
            return this;
        }
    }

    Validator.DEFAULTS = {
        showDefault : true,
        correctClass: &#x27;success&#x27;,
        errorClass  : &#x27;danger&#x27;
    }
    Validator.rules = {
        /**
         * @description  用户
         * */
        user: {
            ajax :{
                url : &#x27;server.json&#x27;,
                data : {},
                success : function( res ){
                    return res ;
                }
            },
            valid: &quot;^[a-z\d_\u4e00-\u9fa5]{6,20}&quot;,
            // ajax    :   function( callback ){ $.get(&#x27;&#x27;,{} , function(data){ callback &amp;&amp; callback.call(this , true) }); }
            message: &#x27;6~20位字符，由字母与数字组成，只能以字母开头&#x27;,
            error: &#x27;输入用户名格式不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入用户名!&#x27;
        },
        /**
         * @description  手机
         * */
        tel: {
            valid: function (val) {
                return $.valid.isTel(val);
            },
            message: &#x27;请输入您的手机号码!&#x27;,
            error: &#x27;输入手机号码不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入您的手机号码!&#x27;
        },
        /**
         * @description  电子邮件
         * */
        email: {
            valid: function (val) {
                return $.valid.isEmail(val);
            },
            message: &#x27;请输入Email地址,示例:czy0816@gmail.com!&#x27;,
            error: &#x27;输入的Email地址格式不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入输入的Email地址!&#x27;
        },
        /**
         * @description  身份证
         * */
        cardId: {
            valid: function (val) {
                return $.valid.isCardIdx(val);
            },
            message: &#x27;请输入身份证号码,示例:35072119860316355!&#x27;,
            error: &#x27;输入身份证号码格式不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入身份证号码!&#x27;
        },
        /**
         * @description  RMB
         * */
        money: {
            valid: function (val) {
                return $.valid.isMoney(val);
            },
            message: &#x27;请输入RMB!&#x27;,
            error: &#x27;输入RMB格式不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入RMB!&#x27;
        },
        /**
         * @description  地址
         * */
        url: {
            valid: function (val) {
                return $.valid.isURL(val);
            },
            message: &#x27;请输入网址,例如:http://www.test.com&#x27;,
            error: &#x27;输入网址格式不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入网址!&#x27;
        },
        /**
         * @description  ip
         * */
        ip: {
            valid: function (val) {
                return $.valid.isIP(val);
            },
            message: &#x27;请输入ip,例如:192.168.1.1!&#x27;,
            error: &#x27;输入ip格式不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入ip!&#x27;
        },
        /**
         * @description  时间
         * */
        date: {
            valid: function (val) {
                return $.valid.isDate(val);
            },
            message: &#x27;请输入时间,示例:2012-12-12!&#x27;,
            error: &#x27;输入的时间格式不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入时间,示例:2012-12-12!&#x27;
        },
        /**
         * @description  手机
         * */
        mobile: {
            valid: function (val) {
                return $.valid.isMoblie(val);
            },
            message: &#x27;请输入您的手机号码!&#x27;,
            error: &#x27;输入手机号码不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入您的手机号码!&#x27;
        },
        /**
         * @description  密码
         * */
        password: {
            valid: function (val) {
                return /^[a-z\d_]{6,16}/i.test(val);
            },
            message: &#x27;6~16位字符，字母区分大小写!&#x27;,
            error: &#x27;密码格式不正!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入密码!&#x27;,
            compare: &#x27;两次输入的密码不一致!&#x27;
        },
        /**
         * @description  对比密码
         * */
        conform: {
            valid: function (val) {
                return true;
            },
            message: &#x27;请再次输入密码！&#x27;,
            error: &#x27;密码格式不正!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请再次输入密码!&#x27;,
            compare: &#x27;两次输入的密码不一致!&#x27;
        },
        /**
         * @description  验证码
         * */
        identify: {
            valid: function (val) {
                return true;
            },
            message: &#x27;&#x27;,
            error: &#x27;验证码格式不正！&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入验证码!&#x27;
        },
        /**
         * @description  图片
         * */
        image: {
            valid: function (val) {
                return $.valid.isImage(val);
            },
            message: &#x27;请输入图片格式,支持.bmp,.gif,.png,.jpeg!&#x27;,
            error: &#x27;输入图片格式不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入图片格式!&#x27;
        },
        phone: {
            valid: function (val) {
                return $.valid.isMobileOrTel(val);
            },
            message: &#x27;请输入您的手机号码!&#x27;,
            error: &#x27;输入手机号码不正确!&#x27;,
            correct: &#x27;正确!&#x27;,
            required: &#x27;请输入您的手机号码!&#x27;
        }
    };

    $.fn.validator = function ( options ) {
        var args = arguments;
        return $( this ).each(function(){
            var data = $(this).data(&#x27;validator&#x27;);
            if(!data ){
                data = new Validator( this , options );
                $(this).data(&#x27;validator&#x27; , data);
            }
            var g = [];
            for( var i = 1 ; i &lt; args.length ; i ++ ){
                g.push(args[i]);
            }
            // TODO 构造函数
            var fn = new Function( &#x27;data&#x27; , &#x27;options&#x27; , &#x27;args&#x27; ,&#x27;return data[ options ](args)&#x27;);

            options &amp;&amp; data[ options ] &amp;&amp; fn( data , options , g.join(&#x27;,&#x27;));
        })
    }

    if( typeof module === &quot;object&quot; &amp;&amp; typeof module.exports === &quot;object&quot;  ){
        module.exports = Validator;
    }


})(window.jQuery || Zepto);


    </pre>
</div>

                </div>
            </div>
        </div>
    </div>
<a id="gotoTop" class='well well-small' href='#'>
    Top
</a>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/config.js"></script>
<script src="../assets/js/doc.js"></script>
</body>
</html>
