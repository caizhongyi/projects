<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>..\node_modules\angular-ui-router\lib\angular-1.2.14\angular-sanitize.js - SmartDoc</title>
  
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-smart">
 <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
               <a class="navbar-brand mainlogo" href="https://github.com/zhh77/smartdoc">
             
            <img alt="SmartDoc" src="../assets/css/logo.png" title="SmartDoc">
            
                SmartDoc
          </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                 <ul class="nav navbar-nav">
                    
                    <li><a href="https://github.com/zhh77/smartdoc">Home</a>
                    </li>
                    
                    <li><a href="/">Document</a>
                    </li>
                    
                    <li><a href="https://github.com/zhh77/smartdoc">About</a>
                    </li>
                    
                </ul>
               <div class="navbar-form navbar-right filterAPi" autocomplete="off">
                <input type="text" id='txtSearchAPI' class="form-control search-query" placeholder="Search for API" />
                 <ul id="filterList" class="filterItems dropdown-menu" role="menu"></ul>
                </div>
            </div>
        </div>
    </nav>
    <div id="sidebar">
    <h3>Modules/Classes</h3>
        <div id="api-tabview-filter">
            <input id='txtSearch' type="search" class="form-control" placeholder="Type to filter Modules/Classes">
        </div>
        <dl id="sidebar_list">
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/273.html">273</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/alienjs.html">alienjs</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/window.require.html">window.require</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Countdown.html">Countdown</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/Date.html">Date</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/jquery.html">jquery</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/jquery.transitionEnd.html">jquery.transitionEnd</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.support.transition.html">jquery.support.transition</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.animationEnd.html">jquery.animationEnd</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/jquery-ui.html">jquery-ui</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/jquery.ajaxPanel.html">jquery.ajaxPanel</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.dialog.html">jquery.dialog</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Array.html">Array</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.browserLowVersion.html">jquery.browserLowVersion</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.confirm.html">jquery.confirm</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/jquery.alert.html">jquery.alert</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ng.html">ng</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/EventEmitter Manages event registering and emitting..html">EventEmitter Manages event registering and emitting.</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ngMock.html">ngMock</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ngMockE2E.html">ngMockE2E</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/ui.html">ui</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/AjaxPanel.html">AjaxPanel</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Date.Dialog.html">Date.Dialog</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/WebUploader.html">WebUploader</a>
                </dt>
                <dd>
                    <ul>
                   
                       <li>
                            
                           <a href="../classes/Base.html">Base</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Mediator.html">Mediator</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/options.Uploader.html">options.Uploader</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/File.File.html">File.File</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/File.Queue.html">File.Queue</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                       <li>
                            
                           <a href="../classes/Uploader.html">Uploader</a>
                           <ul>
                                
                           </ul>
                       </li>
                    
                    </ul>
                </dd>
             
                <dt>
                    <span class="glyphicon glyphicon-minus"></span>
                    <a href="../modules/window.html">window</a>
                </dt>
                <dd>
                    <ul>
                   
                    </ul>
                </dd>
             
        </dl>
</div>
   
    <div class="stdoc-content">
        <!--     <form id="options-form" class="form-inline pull-right">
        Show:
        <label for="api-show-inherited" class="checkbox">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected" class="checkbox">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private" class="checkbox">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated" class="checkbox">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </form>

 -->
        <div class="apidocs">
            <div id="docs-main">
                <div class="content">
                    <div class="page-header">
    <h1>..\node_modules\angular-ui-router\lib\angular-1.2.14\angular-sanitize.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums" id='src_code'>
/**
 * @license AngularJS v1.2.14
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {&#x27;use strict&#x27;;

var $sanitizeMinErr = angular.$$minErr(&#x27;$sanitize&#x27;);

/**
 * @ngdoc module
 * @name ngSanitize
 * @description
 *
 * # ngSanitize
 *
 * The &#x60;ngSanitize&#x60; module provides functionality to sanitize HTML.
 *
 *
 * &lt;div doc-module-components=&quot;ngSanitize&quot;&gt;&lt;/div&gt;
 *
 * See {@link ngSanitize.$sanitize &#x60;$sanitize&#x60;} for usage.
 */

/*
 * HTML Parser By Misko Hevery (misko@hevery.com)
 * based on:  HTML Parser By John Resig (ejohn.org)
 * Original code by Erik Arvidsson, Mozilla Public License
 * http://erik.eae.net/simplehtmlparser/simplehtmlparser.js
 *
 * // Use like so:
 * htmlParser(htmlString, {
 *     start: function(tag, attrs, unary) {},
 *     end: function(tag) {},
 *     chars: function(text) {},
 *     comment: function(text) {}
 * });
 *
 */


/**
 * @ngdoc service
 * @name $sanitize
 * @function
 *
 * @description
 *   The input is sanitized by parsing the html into tokens. All safe tokens (from a whitelist) are
 *   then serialized back to properly escaped html string. This means that no unsafe input can make
 *   it into the returned string, however, since our parser is more strict than a typical browser
 *   parser, it&#x27;s possible that some obscure input, which would be recognized as valid HTML by a
 *   browser, won&#x27;t make it through the sanitizer.
 *   The whitelist is configured using the functions &#x60;aHrefSanitizationWhitelist&#x60; and
 *   &#x60;imgSrcSanitizationWhitelist&#x60; of {@link ng.$compileProvider &#x60;$compileProvider&#x60;}.
 *
 * @param {string} html Html input.
 * @returns {string} Sanitized html.
 *
 * @example
   &lt;example module=&quot;ngSanitize&quot; deps=&quot;angular-sanitize.js&quot;&gt;
   &lt;file name=&quot;index.html&quot;&gt;
     &lt;script&gt;
       function Ctrl($scope, $sce) {
         $scope.snippet =
           &#x27;&lt;p style=&quot;color:blue&quot;&gt;an html\n&#x27; +
           &#x27;&lt;em onmouseover=&quot;this.textContent=\&#x27;PWN3D!\&#x27;&quot;&gt;click here&lt;/em&gt;\n&#x27; +
           &#x27;snippet&lt;/p&gt;&#x27;;
         $scope.deliberatelyTrustDangerousSnippet = function() {
           return $sce.trustAsHtml($scope.snippet);
         };
       }
     &lt;/script&gt;
     &lt;div ng-controller=&quot;Ctrl&quot;&gt;
        Snippet: &lt;textarea ng-model=&quot;snippet&quot; cols=&quot;60&quot; rows=&quot;3&quot;&gt;&lt;/textarea&gt;
       &lt;table&gt;
         &lt;tr&gt;
           &lt;td&gt;Directive&lt;/td&gt;
           &lt;td&gt;How&lt;/td&gt;
           &lt;td&gt;Source&lt;/td&gt;
           &lt;td&gt;Rendered&lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;bind-html-with-sanitize&quot;&gt;
           &lt;td&gt;ng-bind-html&lt;/td&gt;
           &lt;td&gt;Automatically uses $sanitize&lt;/td&gt;
           &lt;td&gt;&lt;pre&gt;&amp;lt;div ng-bind-html=&quot;snippet&quot;&amp;gt;&lt;br/&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;&lt;/td&gt;
           &lt;td&gt;&lt;div ng-bind-html=&quot;snippet&quot;&gt;&lt;/div&gt;&lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;bind-html-with-trust&quot;&gt;
           &lt;td&gt;ng-bind-html&lt;/td&gt;
           &lt;td&gt;Bypass $sanitize by explicitly trusting the dangerous value&lt;/td&gt;
           &lt;td&gt;
           &lt;pre&gt;&amp;lt;div ng-bind-html=&quot;deliberatelyTrustDangerousSnippet()&quot;&amp;gt;
&amp;lt;/div&amp;gt;&lt;/pre&gt;
           &lt;/td&gt;
           &lt;td&gt;&lt;div ng-bind-html=&quot;deliberatelyTrustDangerousSnippet()&quot;&gt;&lt;/div&gt;&lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;bind-default&quot;&gt;
           &lt;td&gt;ng-bind&lt;/td&gt;
           &lt;td&gt;Automatically escapes&lt;/td&gt;
           &lt;td&gt;&lt;pre&gt;&amp;lt;div ng-bind=&quot;snippet&quot;&amp;gt;&lt;br/&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;&lt;/td&gt;
           &lt;td&gt;&lt;div ng-bind=&quot;snippet&quot;&gt;&lt;/div&gt;&lt;/td&gt;
         &lt;/tr&gt;
       &lt;/table&gt;
       &lt;/div&gt;
   &lt;/file&gt;
   &lt;file name=&quot;protractor.js&quot; type=&quot;protractor&quot;&gt;
     it(&#x27;should sanitize the html snippet by default&#x27;, function() {
       expect(element(by.css(&#x27;#bind-html-with-sanitize div&#x27;)).getInnerHtml()).
         toBe(&#x27;&lt;p&gt;an html\n&lt;em&gt;click here&lt;/em&gt;\nsnippet&lt;/p&gt;&#x27;);
     });

     it(&#x27;should inline raw snippet if bound to a trusted value&#x27;, function() {
       expect(element(by.css(&#x27;#bind-html-with-trust div&#x27;)).getInnerHtml()).
         toBe(&quot;&lt;p style=\&quot;color:blue\&quot;&gt;an html\n&quot; +
              &quot;&lt;em onmouseover=\&quot;this.textContent=&#x27;PWN3D!&#x27;\&quot;&gt;click here&lt;/em&gt;\n&quot; +
              &quot;snippet&lt;/p&gt;&quot;);
     });

     it(&#x27;should escape snippet without any filter&#x27;, function() {
       expect(element(by.css(&#x27;#bind-default div&#x27;)).getInnerHtml()).
         toBe(&quot;&amp;lt;p style=\&quot;color:blue\&quot;&amp;gt;an html\n&quot; +
              &quot;&amp;lt;em onmouseover=\&quot;this.textContent=&#x27;PWN3D!&#x27;\&quot;&amp;gt;click here&amp;lt;/em&amp;gt;\n&quot; +
              &quot;snippet&amp;lt;/p&amp;gt;&quot;);
     });

     it(&#x27;should update&#x27;, function() {
       element(by.model(&#x27;snippet&#x27;)).clear();
       element(by.model(&#x27;snippet&#x27;)).sendKeys(&#x27;new &lt;b onclick=&quot;alert(1)&quot;&gt;text&lt;/b&gt;&#x27;);
       expect(element(by.css(&#x27;#bind-html-with-sanitize div&#x27;)).getInnerHtml()).
         toBe(&#x27;new &lt;b&gt;text&lt;/b&gt;&#x27;);
       expect(element(by.css(&#x27;#bind-html-with-trust div&#x27;)).getInnerHtml()).toBe(
         &#x27;new &lt;b onclick=&quot;alert(1)&quot;&gt;text&lt;/b&gt;&#x27;);
       expect(element(by.css(&#x27;#bind-default div&#x27;)).getInnerHtml()).toBe(
         &quot;new &amp;lt;b onclick=\&quot;alert(1)\&quot;&amp;gt;text&amp;lt;/b&amp;gt;&quot;);
     });
   &lt;/file&gt;
   &lt;/example&gt;
 */
function $SanitizeProvider() {
  this.$get = [&#x27;$$sanitizeUri&#x27;, function($$sanitizeUri) {
    return function(html) {
      var buf = [];
      htmlParser(html, htmlSanitizeWriter(buf, function(uri, isImage) {
        return !/^unsafe/.test($$sanitizeUri(uri, isImage));
      }));
      return buf.join(&#x27;&#x27;);
    };
  }];
}

function sanitizeText(chars) {
  var buf = [];
  var writer = htmlSanitizeWriter(buf, angular.noop);
  writer.chars(chars);
  return buf.join(&#x27;&#x27;);
}


// Regular Expressions for parsing tags and attributes
var START_TAG_REGEXP =
       /^&lt;\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:&quot;[^&quot;]*&quot;)|(?:&#x27;[^&#x27;]*&#x27;)|[^&gt;\s]+))?)*)\s*(\/?)\s*&gt;/,
  END_TAG_REGEXP = /^&lt;\s*\/\s*([\w:-]+)[^&gt;]*&gt;/,
  ATTR_REGEXP = /([\w:-]+)(?:\s*=\s*(?:(?:&quot;((?:[^&quot;])*)&quot;)|(?:&#x27;((?:[^&#x27;])*)&#x27;)|([^&gt;\s]+)))?/g,
  BEGIN_TAG_REGEXP = /^&lt;/,
  BEGING_END_TAGE_REGEXP = /^&lt;\s*\//,
  COMMENT_REGEXP = /&lt;!--(.*?)--&gt;/g,
  DOCTYPE_REGEXP = /&lt;!DOCTYPE([^&gt;]*?)&gt;/i,
  CDATA_REGEXP = /&lt;!\[CDATA\[(.*?)]]&gt;/g,
  // Match everything outside of normal chars and &quot; (quote character)
  NON_ALPHANUMERIC_REGEXP = /([^\#-~| |!])/g;


// Good source of info about elements and attributes
// http://dev.w3.org/html5/spec/Overview.html#semantics
// http://simon.html5.org/html-elements

// Safe Void Elements - HTML5
// http://dev.w3.org/html5/spec/Overview.html#void-elements
var voidElements = makeMap(&quot;area,br,col,hr,img,wbr&quot;);

// Elements that you can, intentionally, leave open (and which close themselves)
// http://dev.w3.org/html5/spec/Overview.html#optional-tags
var optionalEndTagBlockElements = makeMap(&quot;colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr&quot;),
    optionalEndTagInlineElements = makeMap(&quot;rp,rt&quot;),
    optionalEndTagElements = angular.extend({},
                                            optionalEndTagInlineElements,
                                            optionalEndTagBlockElements);

// Safe Block Elements - HTML5
var blockElements = angular.extend({}, optionalEndTagBlockElements, makeMap(&quot;address,article,&quot; +
        &quot;aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,&quot; +
        &quot;h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul&quot;));

// Inline Elements - HTML5
var inlineElements = angular.extend({}, optionalEndTagInlineElements, makeMap(&quot;a,abbr,acronym,b,&quot; +
        &quot;bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,&quot; +
        &quot;samp,small,span,strike,strong,sub,sup,time,tt,u,var&quot;));


// Special Elements (can contain anything)
var specialElements = makeMap(&quot;script,style&quot;);

var validElements = angular.extend({},
                                   voidElements,
                                   blockElements,
                                   inlineElements,
                                   optionalEndTagElements);

//Attributes that have href and hence need to be sanitized
var uriAttrs = makeMap(&quot;background,cite,href,longdesc,src,usemap&quot;);
var validAttrs = angular.extend({}, uriAttrs, makeMap(
    &#x27;abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,&#x27;+
    &#x27;color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,&#x27;+
    &#x27;ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,&#x27;+
    &#x27;scope,scrolling,shape,size,span,start,summary,target,title,type,&#x27;+
    &#x27;valign,value,vspace,width&#x27;));

function makeMap(str) {
  var obj = {}, items = str.split(&#x27;,&#x27;), i;
  for (i = 0; i &lt; items.length; i++) obj[items[i]] = true;
  return obj;
}


/**
 * @example
 * htmlParser(htmlString, {
 *     start: function(tag, attrs, unary) {},
 *     end: function(tag) {},
 *     chars: function(text) {},
 *     comment: function(text) {}
 * });
 *
 * @param {string} html string
 * @param {object} handler
 */
function htmlParser( html, handler ) {
  var index, chars, match, stack = [], last = html;
  stack.last = function() { return stack[ stack.length - 1 ]; };

  while ( html ) {
    chars = true;

    // Make sure we&#x27;re not in a script or style element
    if ( !stack.last() || !specialElements[ stack.last() ] ) {

      // Comment
      if ( html.indexOf(&quot;&lt;!--&quot;) === 0 ) {
        // comments containing -- are not allowed unless they terminate the comment
        index = html.indexOf(&quot;--&quot;, 4);

        if ( index &gt;= 0 &amp;&amp; html.lastIndexOf(&quot;--&gt;&quot;, index) === index) {
          if (handler.comment) handler.comment( html.substring( 4, index ) );
          html = html.substring( index + 3 );
          chars = false;
        }
      // DOCTYPE
      } else if ( DOCTYPE_REGEXP.test(html) ) {
        match = html.match( DOCTYPE_REGEXP );

        if ( match ) {
          html = html.replace( match[0] , &#x27;&#x27;);
          chars = false;
        }
      // end tag
      } else if ( BEGING_END_TAGE_REGEXP.test(html) ) {
        match = html.match( END_TAG_REGEXP );

        if ( match ) {
          html = html.substring( match[0].length );
          match[0].replace( END_TAG_REGEXP, parseEndTag );
          chars = false;
        }

      // start tag
      } else if ( BEGIN_TAG_REGEXP.test(html) ) {
        match = html.match( START_TAG_REGEXP );

        if ( match ) {
          html = html.substring( match[0].length );
          match[0].replace( START_TAG_REGEXP, parseStartTag );
          chars = false;
        }
      }

      if ( chars ) {
        index = html.indexOf(&quot;&lt;&quot;);

        var text = index &lt; 0 ? html : html.substring( 0, index );
        html = index &lt; 0 ? &quot;&quot; : html.substring( index );

        if (handler.chars) handler.chars( decodeEntities(text) );
      }

    } else {
      html = html.replace(new RegExp(&quot;(.*)&lt;\\s*\\/\\s*&quot; + stack.last() + &quot;[^&gt;]*&gt;&quot;, &#x27;i&#x27;),
        function(all, text){
          text = text.replace(COMMENT_REGEXP, &quot;$1&quot;).replace(CDATA_REGEXP, &quot;$1&quot;);

          if (handler.chars) handler.chars( decodeEntities(text) );

          return &quot;&quot;;
      });

      parseEndTag( &quot;&quot;, stack.last() );
    }

    if ( html == last ) {
      throw $sanitizeMinErr(&#x27;badparse&#x27;, &quot;The sanitizer was unable to parse the following block &quot; +
                                        &quot;of html: {0}&quot;, html);
    }
    last = html;
  }

  // Clean up any remaining tags
  parseEndTag();

  function parseStartTag( tag, tagName, rest, unary ) {
    tagName = angular.lowercase(tagName);
    if ( blockElements[ tagName ] ) {
      while ( stack.last() &amp;&amp; inlineElements[ stack.last() ] ) {
        parseEndTag( &quot;&quot;, stack.last() );
      }
    }

    if ( optionalEndTagElements[ tagName ] &amp;&amp; stack.last() == tagName ) {
      parseEndTag( &quot;&quot;, tagName );
    }

    unary = voidElements[ tagName ] || !!unary;

    if ( !unary )
      stack.push( tagName );

    var attrs = {};

    rest.replace(ATTR_REGEXP,
      function(match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {
        var value = doubleQuotedValue
          || singleQuotedValue
          || unquotedValue
          || &#x27;&#x27;;

        attrs[name] = decodeEntities(value);
    });
    if (handler.start) handler.start( tagName, attrs, unary );
  }

  function parseEndTag( tag, tagName ) {
    var pos = 0, i;
    tagName = angular.lowercase(tagName);
    if ( tagName )
      // Find the closest opened tag of the same type
      for ( pos = stack.length - 1; pos &gt;= 0; pos-- )
        if ( stack[ pos ] == tagName )
          break;

    if ( pos &gt;= 0 ) {
      // Close all the open elements, up the stack
      for ( i = stack.length - 1; i &gt;= pos; i-- )
        if (handler.end) handler.end( stack[ i ] );

      // Remove the open elements from the stack
      stack.length = pos;
    }
  }
}

var hiddenPre=document.createElement(&quot;pre&quot;);
var spaceRe = /^(\s*)([\s\S]*?)(\s*)$/;
/**
 * decodes all entities into regular string
 * @param value
 * @returns {string} A string with decoded entities.
 */
function decodeEntities(value) {
  if (!value) { return &#x27;&#x27;; }

  // Note: IE8 does not preserve spaces at the start/end of innerHTML
  // so we must capture them and reattach them afterward
  var parts = spaceRe.exec(value);
  var spaceBefore = parts[1];
  var spaceAfter = parts[3];
  var content = parts[2];
  if (content) {
    hiddenPre.innerHTML=content.replace(/&lt;/g,&quot;&amp;lt;&quot;);
    // innerText depends on styling as it doesn&#x27;t display hidden elements.
    // Therefore, it&#x27;s better to use textContent not to cause unnecessary
    // reflows. However, IE&lt;9 don&#x27;t support textContent so the innerText
    // fallback is necessary.
    content = &#x27;textContent&#x27; in hiddenPre ?
      hiddenPre.textContent : hiddenPre.innerText;
  }
  return spaceBefore + content + spaceAfter;
}

/**
 * Escapes all potentially dangerous characters, so that the
 * resulting string can be safely inserted into attribute or
 * element text.
 * @param value
 * @returns {string} escaped text
 */
function encodeEntities(value) {
  return value.
    replace(/&amp;/g, &#x27;&amp;amp;&#x27;).
    replace(NON_ALPHANUMERIC_REGEXP, function(value){
      return &#x27;&amp;#&#x27; + value.charCodeAt(0) + &#x27;;&#x27;;
    }).
    replace(/&lt;/g, &#x27;&amp;lt;&#x27;).
    replace(/&gt;/g, &#x27;&amp;gt;&#x27;);
}

/**
 * create an HTML/XML writer which writes to buffer
 * @param {Array} buf use buf.jain(&#x27;&#x27;) to get out sanitized html string
 * @returns {object} in the form of {
 *     start: function(tag, attrs, unary) {},
 *     end: function(tag) {},
 *     chars: function(text) {},
 *     comment: function(text) {}
 * }
 */
function htmlSanitizeWriter(buf, uriValidator){
  var ignore = false;
  var out = angular.bind(buf, buf.push);
  return {
    start: function(tag, attrs, unary){
      tag = angular.lowercase(tag);
      if (!ignore &amp;&amp; specialElements[tag]) {
        ignore = tag;
      }
      if (!ignore &amp;&amp; validElements[tag] === true) {
        out(&#x27;&lt;&#x27;);
        out(tag);
        angular.forEach(attrs, function(value, key){
          var lkey=angular.lowercase(key);
          var isImage = (tag === &#x27;img&#x27; &amp;&amp; lkey === &#x27;src&#x27;) || (lkey === &#x27;background&#x27;);
          if (validAttrs[lkey] === true &amp;&amp;
            (uriAttrs[lkey] !== true || uriValidator(value, isImage))) {
            out(&#x27; &#x27;);
            out(key);
            out(&#x27;=&quot;&#x27;);
            out(encodeEntities(value));
            out(&#x27;&quot;&#x27;);
          }
        });
        out(unary ? &#x27;/&gt;&#x27; : &#x27;&gt;&#x27;);
      }
    },
    end: function(tag){
        tag = angular.lowercase(tag);
        if (!ignore &amp;&amp; validElements[tag] === true) {
          out(&#x27;&lt;/&#x27;);
          out(tag);
          out(&#x27;&gt;&#x27;);
        }
        if (tag == ignore) {
          ignore = false;
        }
      },
    chars: function(chars){
        if (!ignore) {
          out(encodeEntities(chars));
        }
      }
  };
}


// define ngSanitize module and register $sanitize service
angular.module(&#x27;ngSanitize&#x27;, []).provider(&#x27;$sanitize&#x27;, $SanitizeProvider);

/* global sanitizeText: false */

/**
 * @ngdoc filter
 * @name linky
 * @function
 *
 * @description
 * Finds links in text input and turns them into html links. Supports http/https/ftp/mailto and
 * plain email address links.
 *
 * Requires the {@link ngSanitize &#x60;ngSanitize&#x60;} module to be installed.
 *
 * @param {string} text Input text.
 * @param {string} target Window (_blank|_self|_parent|_top) or named frame to open links in.
 * @returns {string} Html-linkified text.
 *
 * @usage
   &lt;span ng-bind-html=&quot;linky_expression | linky&quot;&gt;&lt;/span&gt;
 *
 * @example
   &lt;example module=&quot;ngSanitize&quot; deps=&quot;angular-sanitize.js&quot;&gt;
     &lt;file name=&quot;index.html&quot;&gt;
       &lt;script&gt;
         function Ctrl($scope) {
           $scope.snippet =
             &#x27;Pretty text with some links:\n&#x27;+
             &#x27;http://angularjs.org/,\n&#x27;+
             &#x27;mailto:us@somewhere.org,\n&#x27;+
             &#x27;another@somewhere.org,\n&#x27;+
             &#x27;and one more: ftp://127.0.0.1/.&#x27;;
           $scope.snippetWithTarget = &#x27;http://angularjs.org/&#x27;;
         }
       &lt;/script&gt;
       &lt;div ng-controller=&quot;Ctrl&quot;&gt;
       Snippet: &lt;textarea ng-model=&quot;snippet&quot; cols=&quot;60&quot; rows=&quot;3&quot;&gt;&lt;/textarea&gt;
       &lt;table&gt;
         &lt;tr&gt;
           &lt;td&gt;Filter&lt;/td&gt;
           &lt;td&gt;Source&lt;/td&gt;
           &lt;td&gt;Rendered&lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;linky-filter&quot;&gt;
           &lt;td&gt;linky filter&lt;/td&gt;
           &lt;td&gt;
             &lt;pre&gt;&amp;lt;div ng-bind-html=&quot;snippet | linky&quot;&amp;gt;&lt;br&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;
           &lt;/td&gt;
           &lt;td&gt;
             &lt;div ng-bind-html=&quot;snippet | linky&quot;&gt;&lt;/div&gt;
           &lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;linky-target&quot;&gt;
          &lt;td&gt;linky target&lt;/td&gt;
          &lt;td&gt;
            &lt;pre&gt;&amp;lt;div ng-bind-html=&quot;snippetWithTarget | linky:&#x27;_blank&#x27;&quot;&amp;gt;&lt;br&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;
          &lt;/td&gt;
          &lt;td&gt;
            &lt;div ng-bind-html=&quot;snippetWithTarget | linky:&#x27;_blank&#x27;&quot;&gt;&lt;/div&gt;
          &lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;escaped-html&quot;&gt;
           &lt;td&gt;no filter&lt;/td&gt;
           &lt;td&gt;&lt;pre&gt;&amp;lt;div ng-bind=&quot;snippet&quot;&amp;gt;&lt;br&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;&lt;/td&gt;
           &lt;td&gt;&lt;div ng-bind=&quot;snippet&quot;&gt;&lt;/div&gt;&lt;/td&gt;
         &lt;/tr&gt;
       &lt;/table&gt;
     &lt;/file&gt;
     &lt;file name=&quot;protractor.js&quot; type=&quot;protractor&quot;&gt;
       it(&#x27;should linkify the snippet with urls&#x27;, function() {
         expect(element(by.id(&#x27;linky-filter&#x27;)).element(by.binding(&#x27;snippet | linky&#x27;)).getText()).
             toBe(&#x27;Pretty text with some links: http://angularjs.org/, us@somewhere.org, &#x27; +
                  &#x27;another@somewhere.org, and one more: ftp://127.0.0.1/.&#x27;);
         expect(element.all(by.css(&#x27;#linky-filter a&#x27;)).count()).toEqual(4);
       });

       it(&#x27;should not linkify snippet without the linky filter&#x27;, function() {
         expect(element(by.id(&#x27;escaped-html&#x27;)).element(by.binding(&#x27;snippet&#x27;)).getText()).
             toBe(&#x27;Pretty text with some links: http://angularjs.org/, mailto:us@somewhere.org, &#x27; +
                  &#x27;another@somewhere.org, and one more: ftp://127.0.0.1/.&#x27;);
         expect(element.all(by.css(&#x27;#escaped-html a&#x27;)).count()).toEqual(0);
       });

       it(&#x27;should update&#x27;, function() {
         element(by.model(&#x27;snippet&#x27;)).clear();
         element(by.model(&#x27;snippet&#x27;)).sendKeys(&#x27;new http://link.&#x27;);
         expect(element(by.id(&#x27;linky-filter&#x27;)).element(by.binding(&#x27;snippet | linky&#x27;)).getText()).
             toBe(&#x27;new http://link.&#x27;);
         expect(element.all(by.css(&#x27;#linky-filter a&#x27;)).count()).toEqual(1);
         expect(element(by.id(&#x27;escaped-html&#x27;)).element(by.binding(&#x27;snippet&#x27;)).getText())
             .toBe(&#x27;new http://link.&#x27;);
       });

       it(&#x27;should work with the target property&#x27;, function() {
        expect(element(by.id(&#x27;linky-target&#x27;)).
            element(by.binding(&quot;snippetWithTarget | linky:&#x27;_blank&#x27;&quot;)).getText()).
            toBe(&#x27;http://angularjs.org/&#x27;);
        expect(element(by.css(&#x27;#linky-target a&#x27;)).getAttribute(&#x27;target&#x27;)).toEqual(&#x27;_blank&#x27;);
       });
     &lt;/file&gt;
   &lt;/example&gt;
 */
angular.module(&#x27;ngSanitize&#x27;).filter(&#x27;linky&#x27;, [&#x27;$sanitize&#x27;, function($sanitize) {
  var LINKY_URL_REGEXP =
        /((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}&lt;&gt;]/,
      MAILTO_REGEXP = /^mailto:/;

  return function(text, target) {
    if (!text) return text;
    var match;
    var raw = text;
    var html = [];
    var url;
    var i;
    while ((match = raw.match(LINKY_URL_REGEXP))) {
      // We can not end in these as they are sometimes found at the end of the sentence
      url = match[0];
      // if we did not match ftp/http/mailto then assume mailto
      if (match[2] == match[3]) url = &#x27;mailto:&#x27; + url;
      i = match.index;
      addText(raw.substr(0, i));
      addLink(url, match[0].replace(MAILTO_REGEXP, &#x27;&#x27;));
      raw = raw.substring(i + match[0].length);
    }
    addText(raw);
    return $sanitize(html.join(&#x27;&#x27;));

    function addText(text) {
      if (!text) {
        return;
      }
      html.push(sanitizeText(text));
    }

    function addLink(url, text) {
      html.push(&#x27;&lt;a &#x27;);
      if (angular.isDefined(target)) {
        html.push(&#x27;target=&quot;&#x27;);
        html.push(target);
        html.push(&#x27;&quot; &#x27;);
      }
      html.push(&#x27;href=&quot;&#x27;);
      html.push(url);
      html.push(&#x27;&quot;&gt;&#x27;);
      addText(text);
      html.push(&#x27;&lt;/a&gt;&#x27;);
    }
  };
}]);


})(window, window.angular);

    </pre>
</div>

                </div>
            </div>
        </div>
    </div>
<a id="gotoTop" class='well well-small' href='#'>
    Top
</a>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/config.js"></script>
<script src="../assets/js/doc.js"></script>
</body>
</html>
