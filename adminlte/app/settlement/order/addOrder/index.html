<!-- Content Header (Page header) -->
<section class="content-header" >
    <h1>
        {{ $state.current.page.title }}
        <small></small>
    </h1>
    <ol class="breadcrumb">
        <li ui-sref-active="active"><a href="#" ui-sref="mbs-index-home"><i class="fa fa-dashboard"></i>首页</a>
        </li>
        <li class="active">  {{ $state.current.page.title }} </li>
    </ol>
</section>
<!-- Main content -->
<section class="content slide" >
    <div class="box " >
        <form name="form" ng-submit="submit(form.$valid)"  role="form" novalidate>

            <div class="modv2-bheader clearfix">
                <div class="modv2-bheader-in ">
                    <span class="modv2-c ">您即将建立合同订单，请确认收款金额。</span>
                </div>
            </div>
            <table input-max-fee="" class="table modv2-table table-hover">
                <tbody>
                <tr>
                    <th width="12%"><label><span class="text-danger">*</span> 车牌号码：</label></th>
                    <td>
                        <div class="form-group ">
                            <input type="text" placeholder="车牌号码" id="car_number" class="form-control modv2-inputg" name="car_number" ng-model="item.car_number" ng-disabled="car_disabled"  required >
                            <div class="has-feedback text-danger" ng-messages="form.car_number.$error" ng-show="form.$submitted">
                                <div ng-message="required"><i class="fa fa-info-circle"></i>请输入车牌号码！</div>
                                <!--<div ng-message="pattern"><i class="fa fa-info-circle"></i>输入车牌号码不正确！</div>-->
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th width="12%"><label><span class="text-danger">*</span> 收款金额：</label></th>
                    <td>
                        <input type="text" placeholder="收款金额" id="fee" class="form-control modv2-inputg" name="fee"  required ng-model="item.fee" ng-pattern="/^([1-9]{1}[0-9]{0,7}|1000000000)$/" >
                        <div class="text-danger">请输入收款总金额，同一订单可分笔支付！</div>
                        <div class="has-feedback text-danger" ng-messages="form.fee.$error" ng-show="form.$submitted">
                            <div ng-message="pattern"><i class="fa fa-info-circle"></i> 请输入金额类型大于0小于1亿！</div>
                        </div>
                    </td>
                </tr>
                <tr ng-if="utils.hasRoleCode('cfb.caiwu.manage,cfb.business')">
                    <th><h4 class="box-title"><span class="text-danger">*</span>归属门店</h4></th>
                    <td colspan="2">
                        <div class="form-group modv2-formg " style="margin-bottom: 10px;">
                            <select  class="form-control " style="width: 120px;" name="province" ng-model="item.province" ung-select-province=""  required >
                                <option value="">省份</option>
                            </select>
                        </div>
                        <div class="form-group modv2-formg " style="margin-bottom: 10px;">
                            <select  class="form-control "  style="width: 120px;" name="city" ng-model="item.city"  ung-select-city="item.province" required>
                                <option value="">市/区</option>
                            </select>
                        </div>
                        <div class="form-group modv2-formg ">
                            <select  class="form-control "  style="width: 120px;" name="shop" ng-model="item.shop" ung-select-shop="item.city" required>
                                <option value="">门店</option>
                            </select>
                        </div>
                        <div class="has-feedback text-danger" ng-messages="form.province.$error" ng-show="interacted(form.province)">
                            <div ng-message="required"><i class="fa fa-info-circle"></i>请选择省份！</div>
                        </div>
                        <div class="has-feedback text-danger" ng-messages="form.city.$error" ng-show="interacted(form.city)">
                            <div ng-message="required"><i class="fa fa-info-circle"></i>请选择市/区！</div>
                        </div>
                        <div class="has-feedback text-danger" ng-messages="form.shop.$error" ng-show="interacted(form.shop)">
                            <div ng-message="required"><i class="fa fa-info-circle"></i>请选择门店！</div>
                        </div>
                    </td>
                </tbody>
            </table>
            <button class="btn btn-primary modv2-btn">保存并收款</button>
       </form>
    </div>
</section>
<!-- /.content -->



<script type="text/ng-template" id="tpl-message.html">
    <form role="form" name="messageForm" ng-submit="submitMessageForm(messageForm.$valid)" novalidate>
        <div class="modal-header">
           <!-- <button aria-label="Close" data-dismiss="modal" class="close" type="button" ng-click="cancel()"><span aria-hidden="true">×</span></button>-->
            <h3 class="modal-title">车牌号重复提醒</h3>
        </div>
        <div class="modal-body">
                <div class="box-body">
                        <div class="box-body">
                            <div class="form-group" >
                                 车牌号 <strong class="text-success">{{ item.car_number }}</strong>  已建立过订单，订单编号： <strong class="text-danger">{{ item.order_no }}</strong>
                            </div>
                            <div class="form-group"> 订单金额不足可 <a href="javascript:;" ng-click="goToUpdate()">修改订单金额</a>，是否要再次建立订单？</div>
                            <div class="form-group">
                                <label for="reason"> 再次建立订单理由：</label>
                                <input type="text" placeholder="输入理由" id="reason" class="form-control" required name="reason" ng-model="item.repeat_add_reason" value="{{ item.repeat_add_reason }}">
                                  <div class="has-feedback text-danger" ng-messages="messageForm.reason.$error" ng-show="messageForm.$submitted">
                                <div ng-message="required"><i class="fa fa-info-circle"></i> 请填写重复建订单原因!</div>
                            </div>
                            </div>
                        </div><!-- /.box-body -->
                </div><!-- /.box-body -->
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary modv2-btn" > 再次建立订单</button>
            <button class="btn btn-primary modv2-btn" ng-click="goToList()" type="button"> 不建新的，就它了</button>
        </div>
    </form>

</script>


<script type="text/ng-template" id="tpl-success.html">
    <form role="form" name="messageForm" >
        <div class="modal-header">
            <button aria-label="Close" data-dismiss="modal" class="close" type="button" ng-click="cancel()"><span aria-hidden="true">×</span></button>
            <h3 class="modal-title">订单建立成功</h3>
        </div>
        <div class="modal-body">
            <form role="form">
                <div class="box-body">
                    <div class="box-body">
                        <div class="form-group">
                            恭喜！车牌号 <strong class="text-success">{{ item.car_number }}</strong> 已成功建立订单，订单编号：
                        </div>
                        <div class="form-group"> <h1 class="text-danger text-center">{{ item.order_no }}</h1> </div>
                        <div class="form-group text-right">
                            如有问题您可以在这里 <a href="javascript:;" ng-click="goToUpdate()">修改订单</a>
                        </div>
                    </div><!-- /.box-body -->
                </div><!-- /.box-body -->
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary " ng-click="cancelAndGo()"  type="button">回到列表</button>
        </div>
    </form>

</script>

