<!-- Content Header (Page header) -->
<section class="content-header" >
    <h1>
        {{ $state.current.page.title }}
        <small></small>
    </h1>
    <ol class="breadcrumb">
        <li ui-sref-active="active"><a href="#" ui-sref="mbs-index-home"><i class="fa fa-dashboard"></i>首页</a>
        </li>
        <li class="active">  {{ $state.current.page.title }} </li>
    </ol>
</section>
<!-- Main content -->
<section class="content slide" >
    <div class="box">
    <div class="box-header ">
        <div class="form form-inline">
            <div class="row">
                <div class="form-group ">
                    <label >订单号：</label>
                    <input type="text" placeholder="订单号" ng-change="searchChange()" ng-model="searchData.contract_no" class="form-control" >
                </div>
                <div class="form-group ">
                    <label >合同号：</label>
                    <input type="text" placeholder="合同号" ng-change="searchChange()" ng-model="searchData.contract_no" class="form-control" >
                </div>
                <div class="form-group ">
                    <label >车牌号：</label>
                    <input type="text" placeholder="车牌号" ng-change="searchChange()" ng-model="searchData.car_number" class="form-control" >
                </div>
                <div class="form-group  ">
                    <label >订单状态：</label>
                    <select class="form-control input-control" name="status" ng-model="settlement.status"  select-order-status="" >
                        <option value="">请选择</option>
                    </select>
                </div>
                <div class="form-group ">
                    <label >开始时间：</label>
                  <span class="input-group datepicker modv2-sel-warap" datepicker-click="startdOpened">
                        <input placeholder="开始时间" type="datetime"  name="start_date"  required ng-model="searchData.start_date"
                               class="form-control" datepicker-popup="yyyy-MM-dd"  is-open="startdOpened"
                               datepicker-options="dateOptions"  ng-required="true"  current-text="今天" clear-text="清空" close-text="关闭"  readonly />

                    </span>
                </div>
                <div class="form-group ">
                    <label >结束时间：</label>
                  <span class="input-group datepicker modv2-sel-warap" datepicker-click="endOpened">
                        <input placeholder="结束时间" type="datetime"  name="end_date"  required ng-model="searchData.end_date"
                               class="form-control" datepicker-popup="yyyy-MM-dd"  is-open="endOpened"
                               datepicker-options="dateOptions"  ng-required="true"  min-date="searchData.start_date" current-text="今天" clear-text="清空" close-text="关闭"  readonly />

                    </span>
                </div>
                <div  class="form-group" select-store="">
                <div class="form-group">
                    <label class="" >门店名称：</label>
                    <select id="province" class="form-control province" name="province" ng-model="settlement.province"  ng-options="item.name for item in province track by item.id"  >
                        <option value="">省份</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="" >&nbsp;</label>
                    <select id="city" class="form-control city" name="city" ng-model="settlement.city"  ng-options="item.name for item in city track by item.id"  >
                        <option value="">市/区</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="" >&nbsp;</label>
                    <select id="shop" class="form-control shop" name="shop" ng-model="settlement.shop"  ng-options="(item.name + '-' + item.id ) for item in shop track by item.id" >
                        <option value="">门店</option>
                    </select>
                </div>
                </div>
                <div class="form-group">
                    <label class="" >&nbsp;</label>
                    <button class="btn btn-default" ng-click="searchInfo()"><i class="fa fa-search"></i> 搜索</button>
                    <button class="btn btn-default" ng-click="output()"> 导出</button>
                </div>
            </div>

        </div>

    </div><!-- /.box-header -->
    <div class="box-body  no-padding">
        <table class="table table-hover" >
            <tbody>
            <tr>
                <th width="100">参考号</th>
                <th >订单信息</th>
                <th >车辆信息</th>
                <th >订单金额</th>
                <th >收款金额(元)</th>
                <th >手续费(元)</th>
                <th >卡别</th>
                <th width="100">操作</th>
            </tr>
            <tr ng-repeat="item in list" class="list-animation">
                <td>625843</td>
                <td >
                    <span class="form-label">订单号：</span> {{item.order_no}} <br/>
                    <span class="form-label">合同编号：</span>  {{item.contract_no}} <br/>
                </td>
                <td >
                    <span class="form-label">车牌号：</span>  {{item.seller_cert_type}} <br/>
                    <span class="form-label">所属门店：</span>  {{item.seller_cert_number}} <br/>
                </td>
                <td >
                    ￥0
                </td>
                <td>
                    ￥5 <span class="text-danger">(免收)</span>
                </td>
                <td >
                    <span class="text-danger">信用卡</span>
                </td>
                <td>
                    <div class="btn-group">
                        <div class="btn-group" dropdown is-open="status.isopen">
                            <button type="button" class="btn btn-primary dropdown-toggle" dropdown-toggle ng-disabled="disabled">
                                操作 <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="javascript：;" ng-click="complete()">查看签购单</a></li>
                                <li><a href="javascript：;" ng-click="edit()">扣除手续费</a></li>
                            </ul>
                        </div>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>

    </div><!-- /.box-body -->
    <div class="box-footer clearfix ">
        <div class="pull-left">
            {{currentPage}} / {{numPages}} 页 | 共 {{ totalItems }} 条
        </div>
        <pagination num-pages="numPages"  boundary-links="true" max-size="maxSize"   ng-change="pageChanged()" total-items="totalItems" ng-model="currentPage" class="pagination pull-right no-margin" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></pagination>
    </div>
    </div>
</section>
<!-- /.content -->

<script type="text/ng-template" id="tpl-update.html">
    <form role="form" name="addForm" ng-submit="submitForm(addForm.$valid)" >
        <div class="modal-header">
            <button aria-label="Close" data-dismiss="modal" class="close" type="button" ng-click="cancel()"><span aria-hidden="true">×</span></button>
            <h3 class="modal-title">添加订单</h3>
        </div>
        <div class="modal-body">

                <div class="box-body">
                    <div class="form-group">
                         您即将建立合同订单，请确认刷卡金额。
                    </div>
                    <div class="form-group">
                        <label for="car_number"><span class="text-danger">*</span> 车牌号码：</label>
                        <input type="text" placeholder="角色名" id="car_number" class="form-control" name="car_number" ng-model="item.car_number" required value="{{ item.car_number }}">
                        <div class="has-feedback text-danger" ng-messages="addForm.car_number.$error" ng-show="interacted(addForm.car_number)">
                            <div ng-message="required"><i class="fa fa-info-circle"></i>请输入刷卡总金额，同一订单可分笔支付。</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="fee"><span class="text-danger">*</span> 刷卡金额：</label>
                        <input type="text" placeholder="刷卡金额" id="fee" class="form-control" name="fee" ng-model="item.fee" ng-pattern="/[0,100000000]/" value="{{ item.fee }}">
                        <div class="has-feedback text-danger" ng-messages="addForm.fee.$error" ng-show="interacted(addForm.fee)">
                            <div ng-message="required"><i class="fa fa-info-circle"></i>请输入刷卡总金额，同一订单可分笔支付。</div>
                            <div ng-message="pattern"><i class="fa fa-info-circle"></i>请输入金额类型大于0小于1亿。</div>
                        </div>
                    </div>

                </div><!-- /.box-body -->

        </div>
        <div class="modal-footer">
            <button class="btn btn-primary modv2-btn" ng-click="ok()">保存并刷卡</button>
            <button class="btn btn-primary modv2-btn" ng-click="cancel()">取消</button>
        </div>
    </form>
</script>

<script type="text/ng-template" id="tpl-message.html">
    <form role="form" name="messageForm" ng-submit="submitMessageForm(messageForm.$valid)" >
        <div class="modal-header">
            <button aria-label="Close" data-dismiss="modal" class="close" type="button" ng-click="cancel()"><span aria-hidden="true">×</span></button>
            <h3 class="modal-title">车牌号重复提醒</h3>
        </div>
        <div class="modal-body">
            <form role="form">
                <div class="box-body">
                        <div class="box-body">
                            <div class="form-group">
                                车牌号闽ADA081已建立过订单，订单编号：
                            </div>
                            <div class="form-group"> 订单金额不足可修改订单金额，是否要再次建立订单？</div>
                            <div class="form-group">
                                <label for="role"> 再次建立订单理由：</label>
                                <input type="text" placeholder="角色名" id="role" class="form-control" name="role_name" ng-model="item.role_name" value="{{ item.role_name }}">
                            </div>
                        </div><!-- /.box-body -->
                </div><!-- /.box-body -->
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary modv2-btn" ng-click="ok()"> 再次建立订单</button>
            <button class="btn btn-primary modv2-btn" ng-click="cancel()"> 不建新的，就它了</button>
        </div>
    </form>

</script>

