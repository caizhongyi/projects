<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        {{ $state.current.page.title }}
        <small></small>
    </h1>
    <ol class="breadcrumb">
        <li ui-sref-active="active"><a href="#" ui-sref="mbs-index-home"><i class="fa fa-dashboard"></i>首页</a></li>
        <li class="active">   {{ $state.current.page.title }} </li>
    </ol>
</section>

<!-- Main content -->
<section class="content slide" >
    <div class="box">
        <div class="box-header">


            <div class="form-inline">
                <div class="form-group">
                    <label class="btn-block" >订单编号:</label>
                    <input type="text" placeholder="订单编号" value="" ng-model="search.order_id" class="form-control" >
                </div>

                <div class="form-group">
                    <label class="btn-block" >订单状态:</label>

                    <select type="text" ng-model="search.order_status" class="form-control">
                        <option></option>
                        <option ng-repeat="order_status in orderstatusList" ng-selected="search.order_status == order_status.status" value="{{order_status.status}}">{{order_status.name}}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="btn-block" > 过户人员:</label>
                    <input type="text" placeholder=" 过户人员"  ng-model="search.change_user" class="form-control" >
                </div>

                <div class="form-group">
                    <label class="btn-block" > 支付金额:</label>
                    <input type="text" placeholder=" 支付金额起"  ng-model="search.min_money" class="form-control" >
                    -
                    <input type="text" placeholder=" 支付金额止"  ng-model="search.max_money" class="form-control" >

                </div>
                <div class="form-group">
                    <label class="" for="car_souce">创建时间：</label>
                    <p class="input-group">
                        <input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="search.min_create" is-open="startopened"  max-date="" datepicker-options="dateOptions" date-disabled="disabled(date, mode)"  close-text="Close" placeholder="起始时间"  />
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-default" ng-click="startopen($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                      </span>
                    </p>
                    -
                    <p class="input-group">
                        <input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="search.max_create" is-open="endopend"  max-date="" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" close-text="Close" placeholder="结束时间"   />
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-default" ng-click="endopen($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                      </span>
                    </p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                </div>
                <div class="form-group">
                    <label class="" for="car_souce">支付时间：</label>

                    <p class="input-group">
                        <input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="search.min_pay" is-open="startopenedb"  max-date="" datepicker-options="dateOptions" date-disabled="disabled(date, mode)"  close-text="Close" placeholder="起始时间"  />
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-default" ng-click="startopenb($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                      </span>
                    </p>
                    -
                    <p class="input-group">
                        <input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="search.max_pay" is-open="endopendb"  max-date="" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" close-text="Close" placeholder="结束时间"   />
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-default" ng-click="endopenb($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                      </span>
                    </p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                </div>
                <div class="form-group">
                    <label class="btn-block">&nbsp;</label>
                    <button class="btn btn-default" ng-click="searchAction()"><i class="fa fa-search"></i> 搜索</button>
                </div>
            </div>
        </div><!-- /.box-header -->
        <div class="box-body  no-padding">
            <table class="table table-hover text-center">
                <tbody>
                    <tr>
                        <th>订单号</th>
                        <th>用户</th>
                        <th>总金额</th>
                        <th>订单状态</th>
                        <th>创建时间</th>
                        <th>支付时间</th>
                        <th>退款时间</th>
                        <th>过户完成时间</th>
                        <th>过户人员</th>
                        <th>所属门店</th>
                        <th>type</th>
                        <th width="10%">操作</th>
                    </tr>
                    <tr ng-repeat="item in list">
                        <td>{{item.order_id}}</td>
                        <td>{{item.user_name}}</td>
                        <td>{{item.all_money}}</td>
                        <td>{{item.order_status| status}}</td>
                        <td>{{item.add_time * 1000 | date:"yyyy-MM-dd hh:mm:ss"  }}</td>
                        <td>{{item.pay_time * 1000 | date:"yyyy-MM-dd hh:mm:ss"  }}</td>
                        <td>{{item.refud_time * 1000 | date:"yyyy-MM-dd hh:mm:ss"  }}</td>
                        <td>{{item.change_finish_time * 1000 | date:"yyyy-MM-dd hh:mm:ss"  }}</td>
                        <td>{{item.change_user_name}}</td>
                        <td>{{item.dept_name}}</td>
                        <td>{{item.flag}}</td>
                        <td>
                            <div class="btn-group">
                                <div class="btn-group" dropdown is-open="status.isopen">
                                    <button type="button" class="btn btn-primary dropdown-toggle" dropdown-toggle ng-disabled="disabled">
                                        操作 <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu" role="menu">
                                        <li><a href="javascript:;" ng-click="edit($index)" ><i class="fa fa-edit"></i> 修改</a></li>
                                        <li><a href="javascript:;" ng-click="update($index)" ng-show="item.flag == 1"  ><i class="fa fa-edit"></i> 委派</a></li>
                                    </ul>
                                </div>

                            </div>
                        </td>
                    </tr>

                </tbody>
            </table>

        </div><!-- /.box-body -->
        <div class="box-footer clearfix ">
            <pagination boundary-links="true"  ng-change="pageChanged()" total-items="totalItems" items-per-page="itemsPerPage"  ng-model="currentPage" class="pagination pull-right no-margin" max-size="10"
                        previous-text="上一页" next-text="下一页" first-text="首页" last-text="末页"></pagination>
        </div>

    </div>

</section>
<!-- /.content -->

<script type="text/ng-template" id="tpl-edit.html">
    <div class="modal-header">
        <button aria-label="Close" data-dismiss="modal" class="close" type="button" ng-click="cancel()"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title">编辑订单信息</h3>
    </div>
    <div class="modal-body">
        <form role="form" name="userForm" class="form-horizontal" ng-submit="update(userForm.$valid)" >
            <div class="box-body">
                <div class="form-group">
                    <label for="update-order_id" class="col-sm-2 control-label">订单编号:</label>
                    <div class="col-sm-10">
                        <input type="text" placeholder="订单编号" id="update-order_id" class="form-control" name="order_id" ng-model="item.order_id" value="{{ item.order_id }}"  ng-readonly="true" >
                    </div>
                </div>

                <div class="form-group">
                    <label for="update-order_status"  class="col-sm-2 control-label">订单状态:</label>
                    <div class="col-sm-10">
                        <select  id="update-order_status" name="order_status" class="form-control" ng-model="item.order_status">
                            <option value="0">未付款</option>
                            <option value="1">己付款</option>
                            <option value="2">办理中</option>
                            <option value="3">已完成</option>
                            <option value="4">退款中</option>
                            <option value="5">已退款</option>
                        </select>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-primary" type="submit" >确定</button>
                    <button class="btn btn-warning" ng-click="cancel()">取消</button>
                </div>
            </div><!-- /.box-body -->
        </form>
    </div>
</script>
<script type="text/ng-template" id="tpl-update.html">
    <div class="modal-header">
        <button aria-label="Close" data-dismiss="modal" class="close" type="button" ng-click="cancel()"><span aria-hidden="true">×</span></button>
        <h3 class="modal-title">更改过户人员信息</h3>
    </div>
    <div class="modal-body">
        <form role="form" name="userForm" class="form-horizontal" ng-submit="update(userForm.$valid)" >
            <div class="box-body">
                <div class="form-group">
                    <label for="update-order_id" class="col-sm-2 control-label">订单编号:</label>
                    <div class="col-sm-10">
                        <input type="text" placeholder="订单编号" id="update-order_id" class="form-control" name="order_id" ng-model="item.order_id" value="{{ item.order_id }}"  ng-readonly="true" >
                    </div>
                </div>

                <div class="form-group">
                    <label for="update-change_user_id"  class="col-sm-2 control-label">过户人员:</label>
                    <div class="col-sm-10">

                        <select type="text"   ng-change="hh(item)" ng-options="item.user_id as item.username for item in item.userList " ng-model="item.change_user_id" class="form-control"   >
                            <option   value="">请选择</option>
                        </select>


                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-primary" type="submit" >确定</button>
                    <button class="btn btn-warning" ng-click="cancel()">取消</button>
                </div>
            </div><!-- /.box-body -->
        </form>
    </div>
</script>