<!-- Content Header (Page header) -->
<section class="content-header" >
    <h1>
        {{ $state.current.page.title }}
        <small></small>
    </h1>
    <ol class="breadcrumb">
        <li ui-sref-active="active"><a href="#" ui-sref="mbs-index-home"><i class="fa fa-dashboard"></i>首页</a></li>
        <li class="active">  {{ $state.current.page.title }} </li>
    </ol>
</section>

<!-- Main content -->
<section class="content slide" >
    <div class="box" senior-table="jhccontract" added-reload="false">
        <div class="box-header ">
            <div class="form form-inline form-alignment" >
                <div class="form-group form-group-alignment">
                    <label class="form-label">合同编号</label>
                    <input type="text" placeholder="合同号" ng-change="searchChange()" ng-model="searchCondition.contract_no" class="form-control" >
                </div>
                <div class="form-group form-group-alignment">
                    <label class="form-label">车牌号码</label>
                    <input type="text" placeholder="车牌号" ng-change="searchChange()" ng-model="searchCondition.car_number" class="form-control" >
                </div>
                <div class="form-group form-group-alignment">
                    <label class="form-label">状态</label>
                    <select  class="form-control input-control" name="status" ng-model="searchCondition.status">
                        <option value="">请选择</option>
                        <option value="1">草稿</option>
                        <option value="2">未打印</option>
                        <option value="3">已打印</option>
                        <option value="4">已作废</option>
                    </select>
                </div>
                <div>
                    <div class="form-group form-group-alignment">
                        <label class="form-label">成交价格</label>
                        <input type="text" placeholder="成交价格" ng-change="searchChange()" ng-model="searchCondition.sale_price_1" class="form-control" >
                    </div>
                    <div class="form-group form-group-alignment">
                        —
                        <input type="text" placeholder="成交价格" ng-change="searchChange()" ng-model="searchCondition.sale_price_2" class="form-control" >
                    </div>
                    <div class="form-group form-group-alignment">
                        <label class="form-label">信息服务费</label>
                        <input type="text" placeholder="信息服务费" ng-change="searchChange()" ng-model="searchCondition.brokerage_1" class="form-control" >
                    </div>
                    <div class="form-group form-group-alignment">
                        —
                        <input type="text" placeholder="信息服务费" ng-change="searchChange()" ng-model="searchCondition.brokerage_2" class="form-control" >
                    </div>
                </div>
                <div class="form-group form-group-alignment">
                    <div class="form-group form-group-alignment">
                        <label class="form-label">签约日期</label>
                        <span class="input-group datepicker modv2-sel-warap" datepicker-click="startdOpened">
                            <input type="hidden"  ng-model="searchCondition.start_date" />
                            <input placeholder="日/月" type="datetime"  name="start_date"  required ng-model="start_date" sync="searchCondition.start_date" class="form-control" datepicker-popup="yyyy-MM-dd"  is-open="startdOpened" datepicker-options="dateOptions"  ng-required="true"  current-text="今天" clear-text="清空" close-text="关闭"  readonly />
                        </span>
                    </div>
                    <div class="form-group form-group-alignment">
                        —
                        <span class="input-group datepicker modv2-sel-warap" datepicker-click="endOpened">
                            <input type="hidden"  ng-model="searchCondition.end_date"/>
                            <input placeholder="日/月" type="datetime"  name="end_date"  required ng-model="end_date" sync="searchCondition.end_date" class="form-control" datepicker-popup="yyyy-MM-dd"  is-open="endOpened" datepicker-options="dateOptions"  ng-required="true"  min-date="start_date" current-text="今天" clear-text="清空" close-text="关闭"  readonly />
                        </span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">是否巨好车</label>
                        <select  class="form-control input-control" name="is_juhaoche" ng-model="searchCondition.is_juhaoche">
                            <option value="">请选择</option>
                            <option value="1">是</option>
                            <option value="0">否</option>
                        </select>
                    </div>
                    <div class="form-group modv2-formg" ng-if="!utils.hasRoleCode('cfb.caiwu.recheck,cfb.caiwu.manage,cfb.caiwu.pay,jhc.contract.manage')">
                        <label class="form-label" >&nbsp;</label>
                        <button class="btn btn-default" ng-click="searchInfo()"  type="button" ><i class="fa fa-search"></i> 搜索</button>
                    </div>
                </div>
                <div class="form-group " select-store="" ng-if="utils.hasRoleCode('cfb.caiwu.recheck,cfb.caiwu.manage,cfb.caiwu.pay,jhc.contract.manage')">
                    <div class="form-group modv2-formg">
                        <label class="form-label">交易顾问</label>
                        <select class="form-control " name="buyer_tracer_province" ng-model="searchCondition.buyer_tracer_province"  ung-select-province=""  >
                            <option value="">省份</option>
                        </select>
                    </div>
                    <div class="form-group modv2-formg">
                        <select class="form-control " name="buyer_tracer_city" ng-model="searchCondition.buyer_tracer_city" ung-select-city="searchCondition.buyer_tracer_province"   >
                            <option value="">市/区</option>
                        </select>
                    </div>
                    <div class="form-group modv2-formg">
                        <select class="form-control " name="buyer_tracer_shop" ng-model="searchCondition.buyer_tracer_shop" ung-select-shop="searchCondition.buyer_tracer_city" >
                            <option value="">门店</option>
                        </select>
                    </div>
                    <div class="form-group modv2-formg">
                        <select class="form-control" name="buyer_tracer" ng-model="searchCondition.buyer_tracer" ung-select-sale-man="searchCondition.buyer_tracer_shop" >
                            <option value="">顾问</option>
                        </select>
                    </div>

                    <div class="form-group modv2-formg">
                        <label class="" >&nbsp;</label>
                        <button class="btn btn-default" ng-click="searchInfo()"  type="button" ><i class="fa fa-search"></i> 搜索</button>
                    </div>
                </div>
                <div class="form-group form-group-alignment" style="margin-bottom: 19px;" ng-if="utils.hasRoleCode('jhc.contract.manage')">
                    <label class="">&nbsp;</label>
                    <button class="btn btn-primary modv2-btn" ng-click="downloadForm()" type="button">导出表格 </button>
                </div>
            </div>
        </div><!-- /.box-header -->
        <div class="box-body no-padding ">
            <table class="table table-hover" >
                <tbody>
                <tr>
                    <th width="12%">编号</th>
                    <th width="10%" >城市</th>
                    <th width="10%" >门店</th>
                    <th width="10%">车辆信息</th>
                    <th width="12%">卖方</th>
                    <th width="8%">买方</th>
                    <th width="8%">交易顾问</th>
                    <th width="8%">成交价格</th>
                    <th width="6%">是否巨好车</th>
                    <th width="6%">合同状态</th>
                    <th width="">操作</th>
                </tr>
                <tr ng-repeat="item in list" class="list-animation">
                    <td >
                        <span class="">编号：</span>
                        <span class="modv2-num"> {{item.contract_no}}</span> <br>
                        <span class="">签订日期：</span>
                        {{item.sign_time  ? (item.sign_time * 1000 | date:"yyyy-MM-dd") : '-'}}
                    </td>
                    <td>
                        <span class=""></span>  {{ item.province_name }} <br/>
                        <span class=""></span>  {{ item.city_name }}
                    </td>
                    <td>
                        <span class=""></span>  {{ item.dept_name }}
                    </td>
                    <td >
                        <span ng-if="!item.car_number">无</span>
                        <span ng-if="item.car_number">
                            <span class="">车牌号：</span>  {{item.car_number}} <br/>
                            <span class="">车型品牌：</span>  {{item.brand_name}} {{item.series_name}}
                        </span>
                    </td>
                    <td >
                        <span class="">姓名：</span>  {{ item.seller_name }} <br/>
                        <span ng-if="item.seller_agent_name">
                            <span class="">代理人：</span>  {{ item.seller_agent_name }}
                        </span>
                    </td>
                    <td >
                        <span class="">姓名：</span>  {{ item.buyer_name }} <br/>
                        <span ng-if="item.buyer_agent_name">
                            <span class="">代理人：</span>  {{ item.buyer_agent_name }}
                        </span>
                    </td>
                    <td >
                        <span class="">卖方：</span>  {{ item.seller_tracer_name }} <br/>
                        <span class="">买方：</span>  {{ item.buyer_tracer_name }}
                    </td>
                    <td >
                        <span class="">成交价：</span>  {{ item.sale_price }} <br/>
                        <span class="">信息服务费：</span>  {{ item.a_brokerage + item.b_brokerage }}
                    </td>
                    <td class="text-center">
                        <span  ng-if="!item.is_jhc">否</span>
                        <span  ng-if="item.is_jhc">是</span>
                    </td>
                    <td class="text-center">
                        <span  ng-if="item.status == 1 ">草稿</span>
                        <span  ng-if="item.status == 2 ">未打印</span>
                        <span  ng-if="item.status == 3 ">已打印</span>
                        <span  ng-if="item.status == 4 ">已作废</span>
                    </td>
                    <td>
                        <span  ng-if="item.status==1 || item.status==2">
                            <a href="javascript:;"  class="modv2-link" ng-click="edit()">编辑</a>
                            <a href="javascript:;"  class="modv2-link" ng-click="del()">删除</a>
                        </span>
                        <span  ng-if="item.status==2">
                            <a href="javascript:;"  class="modv2-link" ng-click="printAgain()">打印</a>
                        </span>
                        <span  ng-if="item.status==3">
                            <a href="javascript:;"  class="modv2-link" ng-click="printAgain()">再次打印</a>
                            <a href="javascript:;"  class="modv2-link" ng-click="remove('确认作废？')">作废</a>
                        </span>
                        <span  ng-if="item.status==4">
                            <a href="javascript:;"  class="modv2-link" ng-click="reAdd()">重新生成</a>
                        </span>
                    </td>
                </tr>
                </tbody>
            </table>

        </div><!-- /.box-body -->
        <div class="box-footer clearfix ">
            <pagination num-pages="numPages"  boundary-links="true" max-size="maxSize"   ng-change="pageChanged()" total-items="totalItems" ng-model="currentPage" class="pagination pull-right no-margin" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></pagination>
            <div class="pull-right ng-binding modv2-pageinfo">
                <span class="modv2-pagecur"> {{currentPage}} </span> / {{numPages}} 页 | 共 {{ totalItems }} 条
            </div>
        </div>
    </div>
</section>
<!-- /.content -->
