(function(a){a.jCanvas=a.jCanvas||{};jCanvas.create=function(e,c){var b=function(){this.init&&this.init.apply(this,arguments)};if(c){for(var d in c.prototype){if(!e[d]){e[d]=c.prototype[d]}}}b.prototype=e;return b};jCanvas.debug={console:function(b){window.console&&console.log(b)}};jCanvas.easing={linear:function(b){return b},swing:function(b){return 0.5-Math.cos(b*Math.PI)/2},def:"easeOutQuad",swing:function(f,g,e,i,h){return sprite.easing[sprite.easing.def](f,g,e,i,h)},easeInQuad:function(f,g,e,i,h){return i*(g/=h)*g+e},easeOutQuad:function(f,g,e,i,h){return -i*(g/=h)*(g-2)+e},easeInOutQuad:function(f,g,e,i,h){if((g/=h/2)<1){return i/2*g*g+e}return -i/2*((--g)*(g-2)-1)+e},easeInCubic:function(f,g,e,i,h){return i*(g/=h)*g*g+e},easeOutCubic:function(f,g,e,i,h){return i*((g=g/h-1)*g*g+1)+e},easeInOutCubic:function(f,g,e,i,h){if((g/=h/2)<1){return i/2*g*g*g+e}return i/2*((g-=2)*g*g+2)+e},easeInQuart:function(f,g,e,i,h){return i*(g/=h)*g*g*g+e},easeOutQuart:function(f,g,e,i,h){return -i*((g=g/h-1)*g*g*g-1)+e},easeInOutQuart:function(f,g,e,i,h){if((g/=h/2)<1){return i/2*g*g*g*g+e}return -i/2*((g-=2)*g*g*g-2)+e},easeInQuint:function(f,g,e,i,h){return i*(g/=h)*g*g*g*g+e},easeOutQuint:function(f,g,e,i,h){return i*((g=g/h-1)*g*g*g*g+1)+e},easeInOutQuint:function(f,g,e,i,h){if((g/=h/2)<1){return i/2*g*g*g*g*g+e}return i/2*((g-=2)*g*g*g*g+2)+e},easeInSine:function(f,g,e,i,h){return -i*Math.cos(g/h*(Math.PI/2))+i+e},easeOutSine:function(f,g,e,i,h){return i*Math.sin(g/h*(Math.PI/2))+e},easeInOutSine:function(f,g,e,i,h){return -i/2*(Math.cos(Math.PI*g/h)-1)+e},easeInExpo:function(f,g,e,i,h){return(g==0)?e:i*Math.pow(2,10*(g/h-1))+e},easeOutExpo:function(f,g,e,i,h){return(g==h)?e+i:i*(-Math.pow(2,-10*g/h)+1)+e},easeInOutExpo:function(f,g,e,i,h){if(g==0){return e}if(g==h){return e+i}if((g/=h/2)<1){return i/2*Math.pow(2,10*(g-1))+e}return i/2*(-Math.pow(2,-10*--g)+2)+e},easeInCirc:function(f,g,e,i,h){return -i*(Math.sqrt(1-(g/=h)*g)-1)+e},easeOutCirc:function(f,g,e,i,h){return i*Math.sqrt(1-(g=g/h-1)*g)+e},easeInOutCirc:function(f,g,e,i,h){if((g/=h/2)<1){return -i/2*(Math.sqrt(1-g*g)-1)+e}return i/2*(Math.sqrt(1-(g-=2)*g)+1)+e},easeInElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return -(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e},easeOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return g*Math.pow(2,-10*h)*Math.sin((h*k-i)*(2*Math.PI)/j)+l+e},easeInOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k/2)==2){return e+l}if(!j){j=k*(0.3*1.5)}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}if(h<1){return -0.5*(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e}return g*Math.pow(2,-10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)*0.5+l+e},easeInBack:function(f,g,e,j,i,h){if(h==undefined){h=1.70158}return j*(g/=i)*g*((h+1)*g-h)+e},easeOutBack:function(f,g,e,j,i,h){if(h==undefined){h=1.70158}return j*((g=g/i-1)*g*((h+1)*g+h)+1)+e},easeInOutBack:function(f,g,e,j,i,h){if(h==undefined){h=1.70158}if((g/=i/2)<1){return j/2*(g*g*(((h*=(1.525))+1)*g-h))+e}return j/2*((g-=2)*g*(((h*=(1.525))+1)*g+h)+2)+e},easeInBounce:function(f,g,e,i,h){return i-sprite.easing.easeOutBounce(f,h-g,0,i,h)+e},easeOutBounce:function(f,g,e,i,h){if((g/=h)<(1/2.75)){return i*(7.5625*g*g)+e}else{if(g<(2/2.75)){return i*(7.5625*(g-=(1.5/2.75))*g+0.75)+e}else{if(g<(2.5/2.75)){return i*(7.5625*(g-=(2.25/2.75))*g+0.9375)+e}else{return i*(7.5625*(g-=(2.625/2.75))*g+0.984375)+e}}}},easeInOutBounce:function(f,g,e,i,h){if(g<h/2){return sprite.easing.easeInBounce(f,g*2,0,i,h)*0.5+e}return sprite.easing.easeOutBounce(f,g*2-h,0,i,h)*0.5+i*0.5+e}};jCanvas.now=function(){return new Date().getTime()};jCanvas.fps;jCanvas.canvas=jCanvas.create({init:function(b){this.elems=[];this.timer},start:function(){var b=this;this.timer=setInterval(function(){for(var c=0;c<b.elems.length;c++){b.elems[c].draw()}},100);return this},stop:function(){clearInterval(this.timer);return this}});jCanvas.sprite=jCanvas.create({});jCanvas.animation=jCanvas.create({init:function(b){b=b||{};this.x=b.x||0;this.y=b.y||0;this.width=b.width||5;this.height=b.height||5;this.opacity=b.opacity==null?1:b.opacity;this.scale=b.scale||{x:1,y:1};this.skew=b.skew||1;this.delayVal;this.isstop;this.motionFncs=[];this.animates={index:0,duration:0,startTime:null}},delay:function(b){this.motionFncs.push({delay:b});return this},repeat:function(b){this.motionFncs.push({repeat:b||-1});return this},draw:function(){},stop:function(){this.isstop=true;return this},countMotionFun:function(b){if(this.isstop){return this}if(this.motionFncs[this.animates.index]){var d=this.motionFncs[this.animates.index];if(typeof d=="object"&&d.fx){d.fx(b,this)}else{if(typeof d=="object"&&d.delay){if(this.delayVal){this.delayVal=jCanvas.now()}if(jCanvas.now()-this.delayVal>=d.delay){d.fx(b,this);this.delayVal=null}}else{if(typeof d=="object"&&d.repeat){for(var c=this.animates.index;c>0;c--){if(this.motionFncs[c].repeat){this.animates.index=(c+1)}}}}}}return this},complete:function(){},animate:function(b,g,i,h){var e=this;if(typeof g=="function"){h=g;g=null}if(typeof i=="function"){h=i;i=null}g=g||2000;i=i||"linear";i="easeOutElastic";this.animates.startTime=jCanvas.now();this.animates.duration=g;var d=function(j,m){var l={};for(var k in j){switch(k){case"scale":l[k]={x:m[k].x||e[k].x,y:m[k].y||e[k].y};break;case"frames":e.frame=j;break;default:l[k]=m[k]||e[k]}}return l};var c=this.motionFncs.length==0?jCanvas.now():this.motionFncs[this.motionFncs.length-1].duration+this.motionFncs[this.motionFncs.length-1].startTime;var f=this.motionFncs.length==0?d(b,this):d(b,this.motionFncs[this.motionFncs.length-1].endAttr);this.motionFncs.push({startTime:c,duration:g,startAttr:f,endAttr:b,fx:function(m,t){var n=function(v,w,p,z,y){return jCanvas.easing[i](v,w,p,z,y)};var l=jCanvas.now(),q=Math.max(0,this.startTime+this.duration-l),u=q/this.duration||0,s=1-u;for(var k in this.endAttr){var o=this.endAttr[k],j=this.startAttr[k];if(k=="scale"&&typeof o!="object"){o={x:o,y:o}}if(typeof o=="object"&&k=="frames"){t.frame=n(s,this.duration*s,0,1,this.duration)*o.length;t.type="image"}else{if(typeof o=="object"){for(var r in o){t[k][r]=n(s,this.duration*s,0,1,this.duration)*(o[r]-o[r])+o[r]}}else{t[k]=n(s,this.duration*s,0,1,this.duration)*(o-j[k])+j[k]}}}if(s>=1){if(t.animates.index<t.motionFncs.length-1){t.animates.index++}t.scale.x=1;t.scale.y=1;h&&h.call(t)}t.draw(m)}});return this}});jCanvas.canvas=jCanvas.create({init:function(c,b){b=b||{};this.canvas=document.getElementById(c);this.sprites=[];this.fps=0;this.frameNum=30;this.ctx=this.canvas.getContext("2d");this.stepTime=1;this.sT;this.x=b.x||0;this.y=b.y||0;this.width=b.width||10;this.height=b.height||10;this.opacity=b.opacity==null?1:b.opacity;this.scale=b.scale||{x:1,y:1};this.skew=b.skew||1;this.motionFncs=[];this.animates={index:0,duration:0,startTime:null}},begin:function(){this.frame=0;this.sT=setTimeout((function(b){return function(){b.render()}})(this),this.stepTime);return this},draw:function(b){console.log(this.scale.x);b.ctx.globalAlpha=this.opacity;b.ctx.translate(this.x,this.y);b.ctx.scale(this.scale.x,this.scale.y);b.ctx.rotate(this.angle*Math.PI/180);return this},render:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.countMotionFun(this);for(var b in this.sprites){if(typeof(this.sprites[b])=="function"){continue}this.sprites[b].countMotionFun(this)}this.sT=setTimeout((function(c){return function(){c.render()}})(this),this.stepTime)},append:function(b){this.sprites[b.id]=b;b.canvas=this;b.animate();return this},remove:function(b){this.sprites[b]&&delete this.sprites[b];return this},stop:function(){clearInterval(this.sT)},clear:function(){for(var b in this.sprites){if(typeof(this.sprites[b])=="function"){continue}delete this.sprites[b]}}},jCanvas.animation);jCanvas.sprite=jCanvas.create({init:function(c,b){b=b||{};this.x=b.x||0;this.y=b.y||0;this.width=b.width||5;this.height=b.height||5;this.opacity=b.opacity==null?1:b.opacity;this.scale=b.scale||{x:1,y:1};this.skew=b.skew||1;this.frame=0;this.frames=[];this.type="circle";this.motionFncs=[];this.animates={index:0,duration:0,startTime:null};this.id=c;this.canvas;jCanvas.debug.console("create element : "+c);return this},draw:function(b){switch(this.type){case"circle":this.drawCircle();break;case"image":this.drawImage();break;default:this.drawCircle();break}return this},drawImage:function(c){c=c||this.canvas;var b=new Image(this.frames[this.frame]);c.ctx.drawImage(b,this.x,this.y,this.width,this.height);return this},drawCircle:function(b){b=b||this.canvas;b.ctx.save();b.ctx.beginPath();b.ctx.lineWidth="1";b.ctx.strokeStyle="#000";b.ctx.fillStyle="rgba("+Math.floor(0)+","+Math.floor(255)+","+Math.floor(255)+","+this.opacity+")";b.ctx.arc(this.x,this.y,5,0,Math.PI*2,true);b.ctx.closePath();b.ctx.stroke();b.ctx.fill();return this},appendTo:function(b){b.sprites[this.id]=this;this.canvas=b;this.animate();return this},remove:function(){this.canvas.sprites[this.id]&&delete this.canvas.sprites[this.id];return this},clone:function(b){}},jCanvas.animation)})(window);