<!DOCTYPE html>
<html>
<head>
    <title></title>

    <meta charset="utf-8">
    <!--<meta content="IE=EmulateIE7" http-equiv="X-UA-Compatible" />-->
    <meta name="keywords" content="keywords"/>
    <meta name="description" content="description"/>
    <meta http-equiv="Window-target" content="_top"/>
    <!-- author  -->
    <meta name="author" content=""/>
    <!-- copyright  -->
    <meta name="copyright" content="2001-2010 Comsenz Inc."/>
    <!-- 文章标签  -->
    <link rel="Bookmark" href="favicon.ico"/>
    <!-- 网站url icon  -->
    <link rel="Shortcut Icon" href="favicon.ico" type="image/x-icon"/>

    <link href="css/style.css" type="text/css" rel="stylesheet" />

    <!-- jquery 库 -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
</head>
<body>
<div class="wrapper">
    <div class="header">
        <h2>用户登录</h2>
        <em><a href="" class="close" title="关闭"></a></em>
    </div>

    <!--main-->
    <div class="con">
        <form id="form" action="">
        <div class="item">
            <div class="tips user-tips" style="display:none;">请输入正确的766通行证帐号！</div>
            <input id="user" name="user" class="input" maxlength="20" value="通行证/电子邮箱:" onfocus="if(this.value=='通行证/电子邮箱:'){this.value='';}" onblur="if(this.value==''){this.value='通行证/电子邮箱:';}" />
        </div>

        <div class="item">
            <div class="tips password-tips" style="display:none ;">请输入正确的766通行证帐号！</div>
            <input id="password" name="password"  class="input" value="密码：" onfocus="if(this.value=='密码：'){this.value='';}" onblur="if(this.value==''){this.value='密码：';}" />
        </div>
        <div style="display: none;"><input class="input" value="验证码：" onfocus="if(this.value=='验证码：'){this.value='';}" onblur="if(this.value==''){this.value='验证码：';}" /></div>
        <div class="code" style="display: none;">
            <img src="" id="cpatch" />
            <a name="send" id="send">看不清楚,换一张</a>

        </div>
        <div class="radio">
            <input type="checkbox" class="checkbox" /><span>记住密码</span>
        </div>
        <div class="clear"></div>
        <div class="button"><a href="javascript:;" id="login-btn" title="登录">登录</a></div>
        <div class="word"><b>其他登录方式：</b><p class="icon"><a href="" title="新浪微博"></a></p><p class="icon2"><a href="" title="腾讯微博"></a></p>
            <div class="forgin">
                <a href="###">忘记密码?</a>|<a href="###">注册新用户</a></div>
        </div>
        </form>
    </div>
    <!--main end-->
</div>


<iframe id="post-message-iframe" src="domain-login-iframe.html" frameborder="0" style="display: none;"></iframe>
<script type="text/javascript">
    $('.close').click(function(){
        post('well');
    })

    var $form = $('#form'),
        $loginBtn = $('.login-btn',$form).click(function(){
            if(!validate.user()){ return false; }
            if(!validate.pwd()){ return false; }
    });

    var validate = {
        user : function(){
            var $tips =  $('.user-tips',$form);
            if(!/^[a-z\d_\u4e00-\u9fa5]{6,20}/i.test($user.val()))
                $tips.text('6~20位字符，由字母与数字组成，只能以字母开头！').show();
            else{
                $tips.hide();
            }
            return ;
        },
        pwd  : function(str){
            return true;
        }
    }

    var $user = $('#user' , $form).bind({
        focus : function(){

        },
        blur : function(){
            validate.user();
        }
    })


    var $password =  $('#password' , $form).bind({
        focus : function(){},
        blur : function(){}
    })

    //document.location.href  = src="login.html?domain=http://www.766.com"
    function getPostDomain(){
          var href = document.location.href,
              args = href.substring(href.lastIndexOf('?'),href.length),
              domain = args.split('=');
        return domain;
    }

    function post(str){
        //注意： frames获取C.html的frame时， cFrameId 是iframe的name属性
        //其中‘redirected=true’故意添加参数，强迫C.html的页面刷新，响应onload事件
        var domain = getPostDomain();
        var ifr = $('#post-message-iframe');

        if(window.postMessage){
            //var domain = 'http://*.766.com';
            window.parent.postMessage(str, domain);  //suport ie7 +
        }
        else{
            ifr.attr('src' ,  domain + '/logincallback.html?redirected=true' + '#' + str);
        }

    }
</script>

<!--[if lte IE 6]>
<script type="text/javascript" src="js/DD_belatedPNG_0.0.8a-min.js"></script>
<script type="text/javascript"> DD_belatedPNG.fix('.png,i');</script>
<![endif]-->
</body>
</html>
