(function(c){ArcheAge.namespace("Preview.Service");ArcheAge.Preview.Service=Class.extend({init:function(){this._bindNeedLoginBtn();this.previewEvent=new ArcheAge.Preview.Event;this.tempId;this.archeageMoviePlayer=new ArcheAge.Preview.MoviePlayer(this);this.cnt=0;new ArcheAge.Preview.SNSButtons;document.attachEvent&&document.attachEvent("onpropertychange",function(a){"title"===a.propertyName&&"ArcheAge Preview"!==document.title&&setTimeout(function(){document.title="ArcheAge Preview"},1)})},_bindNeedLoginBtn:function(){c(".link-login").on("click",
function(a){a.preventDefault();a=accountDomainUrl+"/user/login/form?forwardUrl="+location.href.replace("#","/ArcheAge/");location.href=a})},moveCompleted:function(a){a=a.attr("id");this.tempId!=a&&(this.completedProcess(a),this.tempId=a)},moveBefore:function(){void 0!=this.slideId&&c("#movieFrame").attr("src","")},hasMovie:function(a){a=slideDetailOption[a];return void 0==a||""==a?!1:"true"==a.hasMovie},completedProcess:function(a){this.slideId=a;this.previewEvent.happenEvent(a);this.slideDetail=
slideDetailOption[a];this.isTrailer(a)?(this.previewEvent.closeEventArea(),this.bgm.autoPause(),this.archeageMoviePlayer.makeMoviePlayer(!0)):this.isTrailerAfter()?(this.previewEvent.showEventArea(),this.bgm.play()):(this.archeageMoviePlayer.isPlayed&&(this.bgm.autoPlay(),this.archeageMoviePlayer.isPlayed=!1),this.hasMovie(this.slideId)&&this.archeageMoviePlayer.makeMoviePlayer(!1),void 0==this.tempId&&this.bgm.play())},isTrailer:function(a){return"trailer"===a},isTrailerAfter:function(){return"trailer"===
this.tempId},endProcess:function(){},trailerEnded:function(){"trailer"===this.slideId&&c("#movieEndArea").delay(500).fadeOut(function(){top.location.href="#index"})}});ArcheAge.Preview.MoviePlayer=Class.extend({init:function(a){this.isPlayed=!1;this.preview=a;this.isFull=!0},makeMoviePlayer:function(a){var b=this;b.$contentArea=c("#viewport").find(".content");b.$movieArea=c('<iframe id="movieFrame" style="width:1000px;height:564px;border:0;display:none;" frameborder="0"></iframe>');b.$contentArea.prepend(b.$movieArea);
if(a)b.playToggle();else{b.$poster=b.$contentArea.find("img.poster");var d=b.$contentArea.parent().find(".btn-movieplay");d.on("click",function(){c.browser.msie&&("7.0"==c.browser.version||"8.0"==c.browser.version)?window.open("/preview/movie/"+b.preview.slideId,"ArcheAge_movie","width=1000,height=564,scrollbars=auto,resizable=1"):(b.playToggle(),d.hide(),b.$poster.hide());b.isPlayed=!0;b.preview.bgm.autoPause()})}},playToggle:function(){this.$movieArea.attr("src",("/preview/movie/"+this.preview.slideId).replace("-",
"_"));this.$movieArea.show()},toggleFrame:function(){(this.isFull=this.isFull?!1:!0)?c("#movieFrame").css({position:"",zIndex:"",left:"",top:"",width:"1000px",height:"564px"}):c("#movieFrame").css({position:"fixed",zIndex:"99999",left:0,top:0,width:c(window).width(),height:c(window).height()})}})})(jQuery);